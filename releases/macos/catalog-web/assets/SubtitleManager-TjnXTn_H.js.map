{"version":3,"file":"SubtitleManager-TjnXTn_H.js","sources":["../../src/lib/subtitleApi.ts","../../src/components/subtitles/SubtitleSyncModal.tsx","../../src/types/subtitles.ts","../../src/components/subtitles/SubtitleUploadModal.tsx","../../src/pages/SubtitleManager.tsx"],"sourcesContent":["import api from './api'\nimport type {\n  SubtitleSearchRequest,\n  SubtitleSearchResponse,\n  SubtitleDownloadRequest,\n  SubtitleDownloadResponse,\n  SubtitleTrack,\n  SubtitleSyncVerificationRequest,\n  SubtitleSyncVerificationResponse,\n  SubtitleTranslationRequest,\n  SubtitleTranslationResponse,\n  SupportedLanguage,\n  SupportedProvider,\n  SubtitleMediaInfo\n} from '@/types/subtitles'\n\nexport const subtitleApi = {\n  // Search for subtitles\n  searchSubtitles: (params: SubtitleSearchRequest): Promise<SubtitleSearchResponse> =>\n    api.get('/subtitles/search', { params }).then(res => res.data),\n\n  // Download subtitle\n  downloadSubtitle: (request: SubtitleDownloadRequest): Promise<SubtitleDownloadResponse> =>\n    api.post('/subtitles/download', request).then(res => res.data),\n\n  // Get subtitles for a specific media item\n  getMediaSubtitles: (mediaId: number): Promise<SubtitleMediaInfo> =>\n    api.get(`/subtitles/media/${mediaId}`).then(res => res.data),\n\n  // Verify subtitle synchronization\n  verifySync: (subtitleId: string, mediaId: number, request?: Partial<SubtitleSyncVerificationRequest>): Promise<SubtitleSyncVerificationResponse> =>\n    api.get(`/subtitles/${subtitleId}/verify-sync/${mediaId}`, { params: request }).then(res => res.data),\n\n  // Translate subtitle text\n  translateSubtitle: (request: SubtitleTranslationRequest): Promise<SubtitleTranslationResponse> =>\n    api.post('/subtitles/translate', request).then(res => res.data),\n\n  // Get supported languages\n  getSupportedLanguages: (): Promise<SupportedLanguage[]> =>\n    api.get('/subtitles/languages').then(res => res.data),\n\n  // Get supported providers\n  getSupportedProviders: (): Promise<SupportedProvider[]> =>\n    api.get('/subtitles/providers').then(res => res.data),\n\n  // Delete a subtitle track\n  deleteSubtitle: (subtitleId: string): Promise<{ success: boolean }> =>\n    api.delete(`/subtitles/${subtitleId}`).then(res => res.data),\n\n  // Update subtitle metadata (sync offset, etc.)\n  updateSubtitle: (subtitleId: string, data: Partial<SubtitleTrack>): Promise<SubtitleTrack> =>\n    api.put(`/subtitles/${subtitleId}`, data).then(res => res.data),\n\n  // Upload custom subtitle file\n  uploadSubtitle: (mediaId: number, file: File, language: string, format?: string): Promise<SubtitleDownloadResponse> => {\n    const formData = new FormData()\n    formData.append('file', file)\n    formData.append('media_id', mediaId.toString())\n    formData.append('language', language)\n    if (format) {\n      formData.append('format', format)\n    }\n\n    return api.post('/subtitles/upload', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data',\n      },\n    }).then(res => res.data)\n  },\n}","import React, { useState } from 'react'\nimport { motion } from 'framer-motion'\nimport { X, CheckCircle, AlertCircle, Clock, RefreshCw, Play, Pause } from 'lucide-react'\nimport { subtitleApi } from '@/lib/subtitleApi'\nimport type { SubtitleSyncVerificationResponse } from '@/types/subtitles'\n\ninterface SubtitleSyncModalProps {\n  isOpen: boolean\n  onClose: () => void\n  subtitleId: string\n  mediaId: number\n  subtitleLanguage?: string\n}\n\nexport const SubtitleSyncModal: React.FC<SubtitleSyncModalProps> = ({\n  isOpen,\n  onClose,\n  subtitleId,\n  mediaId,\n  subtitleLanguage\n}) => {\n  const [isVerifying, setIsVerifying] = useState(false)\n  const [verificationResult, setVerificationResult] = useState<SubtitleSyncVerificationResponse | null>(null)\n  const [sampleDuration, setSampleDuration] = useState(60) // seconds\n  const [sensitivity, setSensitivity] = useState(5) // 1-10\n\n  const handleVerify = async () => {\n    setIsVerifying(true)\n    try {\n      const result = await subtitleApi.verifySync(subtitleId, mediaId, {\n        sample_duration: sampleDuration,\n        sensitivity,\n      })\n      setVerificationResult(result)\n    } catch (error) {\n      console.error('Verification failed:', error)\n      setVerificationResult({\n        success: false,\n        status: 'unusable',\n        error: error instanceof Error ? error.message : 'Verification failed'\n      })\n    } finally {\n      setIsVerifying(false)\n    }\n  }\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'perfect':\n        return 'text-green-600 bg-green-100 dark:text-green-400 dark:bg-green-900/20'\n      case 'good':\n        return 'text-blue-600 bg-blue-100 dark:text-blue-400 dark:bg-blue-900/20'\n      case 'acceptable':\n        return 'text-yellow-600 bg-yellow-100 dark:text-yellow-400 dark:bg-yellow-900/20'\n      case 'poor':\n        return 'text-orange-600 bg-orange-100 dark:text-orange-400 dark:bg-orange-900/20'\n      case 'unusable':\n        return 'text-red-600 bg-red-100 dark:text-red-400 dark:bg-red-900/20'\n      default:\n        return 'text-gray-600 bg-gray-100 dark:text-gray-400 dark:bg-gray-900/20'\n    }\n  }\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'perfect':\n      case 'good':\n        return <CheckCircle className=\"w-5 h-5\" />\n      default:\n        return <AlertCircle className=\"w-5 h-5\" />\n    }\n  }\n\n  if (!isOpen) return null\n\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      exit={{ opacity: 0 }}\n      className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\"\n      onClick={onClose}\n    >\n      <motion.div\n        initial={{ scale: 0.95, opacity: 0 }}\n        animate={{ scale: 1, opacity: 1 }}\n        exit={{ scale: 0.95, opacity: 0 }}\n        className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full p-6\"\n        onClick={(e) => e.stopPropagation()}\n      >\n        <div className=\"flex justify-between items-center mb-6\">\n          <h2 className=\"text-xl font-semibold flex items-center gap-2\">\n            <Clock className=\"w-5 h-5\" />\n            Verify Subtitle Sync\n          </h2>\n          <button\n            onClick={onClose}\n            className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg\"\n          >\n            <X className=\"w-5 h-5\" />\n          </button>\n        </div>\n\n        {subtitleLanguage && (\n          <div className=\"mb-4 text-sm text-gray-600 dark:text-gray-400\">\n            Verifying sync for <span className=\"font-medium\">{subtitleLanguage}</span> subtitle\n          </div>\n        )}\n\n        {/* Settings */}\n        <div className=\"space-y-4 mb-6\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              Sample Duration (seconds)\n            </label>\n            <div className=\"flex items-center gap-3\">\n              <input\n                type=\"range\"\n                min=\"30\"\n                max=\"300\"\n                step=\"30\"\n                value={sampleDuration}\n                onChange={(e) => setSampleDuration(Number(e.target.value))}\n                className=\"flex-1\"\n              />\n              <span className=\"text-sm font-medium w-20 text-center\">\n                {sampleDuration}s\n              </span>\n            </div>\n            <p className=\"text-xs text-gray-500 dark:text-gray-500 mt-1\">\n              Longer durations provide more accurate results but take longer\n            </p>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              Sensitivity\n            </label>\n            <div className=\"flex items-center gap-3\">\n              <input\n                type=\"range\"\n                min=\"1\"\n                max=\"10\"\n                value={sensitivity}\n                onChange={(e) => setSensitivity(Number(e.target.value))}\n                className=\"flex-1\"\n              />\n              <span className=\"text-sm font-medium w-8 text-center\">\n                {sensitivity}\n              </span>\n            </div>\n            <p className=\"text-xs text-gray-500 dark:text-gray-500 mt-1\">\n              Higher sensitivity detects smaller sync issues but may produce false positives\n            </p>\n          </div>\n        </div>\n\n        {/* Verification Result */}\n        {verificationResult && (\n          <motion.div\n            initial={{ opacity: 0, y: 10 }}\n            animate={{ opacity: 1, y: 0 }}\n            className={`rounded-lg p-4 mb-6 ${getStatusColor(verificationResult.status)}`}\n          >\n            <div className=\"flex items-center gap-3 mb-3\">\n              {getStatusIcon(verificationResult.status)}\n              <div>\n                <div className=\"font-medium capitalize\">\n                  {verificationResult.status} Sync\n                </div>\n                <div className=\"text-sm opacity-75\">\n                  {verificationResult.message}\n                </div>\n              </div>\n            </div>\n\n            {verificationResult.success && (\n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                {verificationResult.sync_offset !== undefined && (\n                  <div>\n                    <span className=\"opacity-75\">Sync Offset:</span>\n                    <div className=\"font-medium\">\n                      {verificationResult.sync_offset > 0 ? '+' : ''}{verificationResult.sync_offset}ms\n                    </div>\n                  </div>\n                )}\n                {verificationResult.confidence !== undefined && (\n                  <div>\n                    <span className=\"opacity-75\">Confidence:</span>\n                    <div className=\"font-medium\">\n                      {(verificationResult.confidence * 100).toFixed(1)}%\n                    </div>\n                  </div>\n                )}\n                {verificationResult.sync_score !== undefined && (\n                  <div>\n                    <span className=\"opacity-75\">Sync Score:</span>\n                    <div className=\"font-medium\">\n                      {verificationResult.sync_score.toFixed(2)}\n                    </div>\n                  </div>\n                )}\n              </div>\n            )}\n\n            {verificationResult.error && (\n              <div className=\"mt-3 text-sm\">\n                <span className=\"opacity-75\">Error:</span>\n                <div className=\"font-medium\">\n                  {verificationResult.error}\n                </div>\n              </div>\n            )}\n          </motion.div>\n        )}\n\n        {/* Actions */}\n        <div className=\"flex gap-3\">\n          <button\n            onClick={handleVerify}\n            disabled={isVerifying}\n            className=\"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 flex items-center justify-center gap-2\"\n          >\n            {isVerifying ? (\n              <>\n                <RefreshCw className=\"w-4 h-4 animate-spin\" />\n                Verifying...\n              </>\n            ) : (\n              <>\n                <Play className=\"w-4 h-4\" />\n                Start Verification\n              </>\n            )}\n          </button>\n          <button\n            onClick={onClose}\n            className=\"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600\"\n          >\n            Close\n          </button>\n        </div>\n\n        <div className=\"mt-4 text-xs text-gray-500 dark:text-gray-500 text-center\">\n          Verification analyzes audio patterns to detect subtitle synchronization issues\n        </div>\n      </motion.div>\n    </motion.div>\n  )\n}","export interface SubtitleSearchRequest {\n  query?: string\n  language?: string\n  media_path?: string\n  title?: string\n  year?: number\n  season?: number\n  episode?: number\n  providers?: string[]\n  limit?: number\n  offset?: number\n}\n\nexport interface SubtitleSearchResult {\n  id: string\n  media_path?: string\n  title: string\n  year?: number\n  season?: number\n  episode?: number\n  language: string\n  language_name: string\n  provider: string\n  download_url: string\n  rating?: number\n  downloads?: number\n  fps?: number\n  format?: string\n  release?: string\n  hearing_impaired: boolean\n  foreign_parts_only: boolean\n  machine_translated: boolean\n  upload_date?: string\n}\n\nexport interface SubtitleSearchResponse {\n  results: SubtitleSearchResult[]\n  total: number\n  limit: number\n  offset: number\n  query_time_ms: number\n}\n\nexport interface SubtitleDownloadRequest {\n  id: string\n  media_path?: string\n  language?: string\n  encoding?: string\n}\n\nexport interface SubtitleDownloadResponse {\n  success: boolean\n  subtitle_id?: string\n  media_id?: number\n  file_path?: string\n  language?: string\n  format?: string\n  encoding?: string\n  message?: string\n  error?: string\n}\n\nexport interface SubtitleTrack {\n  id: string\n  media_id: number\n  language: string\n  language_name: string\n  provider: string\n  file_path: string\n  format: string\n  encoding: string\n  file_size: number\n  created_at: string\n  updated_at: string\n  sync_offset?: number\n  hearing_impaired: boolean\n  foreign_parts_only: boolean\n  machine_translated: boolean\n  rating?: number\n  verified: boolean\n}\n\nexport interface SubtitleSyncVerificationRequest {\n  subtitle_id: string\n  media_id: number\n  sample_duration?: number\n  sensitivity?: number\n}\n\nexport interface SubtitleSyncVerificationResponse {\n  success: boolean\n  sync_offset?: number\n  sync_score?: number\n  confidence?: number\n  status: 'perfect' | 'good' | 'acceptable' | 'poor' | 'unusable'\n  message?: string\n  error?: string\n}\n\nexport interface SubtitleTranslationRequest {\n  text: string\n  from_language: string\n  to_language: string\n  provider?: string\n}\n\nexport interface SubtitleTranslationResponse {\n  success: boolean\n  translated_text?: string\n  from_language?: string\n  to_language?: string\n  provider?: string\n  confidence?: number\n  message?: string\n  error?: string\n}\n\nexport interface SupportedLanguage {\n  code: string\n  name: string\n  native_name: string\n}\n\nexport interface SupportedProvider {\n  name: string\n  display_name: string\n  enabled: boolean\n  features: string[]\n}\n\nexport interface SubtitleMediaInfo {\n  media_id: number\n  title: string\n  year?: number\n  media_type: string\n  directory_path: string\n  subtitles: SubtitleTrack[]\n}\n\nexport const SUBTITLE_PROVIDERS = [\n  'opensubtitles',\n  'subdb',\n  'yify',\n  'subscene',\n  'addic7ed'\n] as const\n\nexport type SubtitleProvider = typeof SUBTITLE_PROVIDERS[number]\n\nexport const SUBTITLE_FORMATS = [\n  'srt',\n  'vtt',\n  'ass',\n  'ssa',\n  'sub'\n] as const\n\nexport type SubtitleFormat = typeof SUBTITLE_FORMATS[number]\n\nexport const COMMON_LANGUAGES = [\n  { code: 'en', name: 'English', native_name: 'English' },\n  { code: 'es', name: 'Spanish', native_name: 'Español' },\n  { code: 'fr', name: 'French', native_name: 'Français' },\n  { code: 'de', name: 'German', native_name: 'Deutsch' },\n  { code: 'it', name: 'Italian', native_name: 'Italiano' },\n  { code: 'pt', name: 'Portuguese', native_name: 'Português' },\n  { code: 'ru', name: 'Russian', native_name: 'Русский' },\n  { code: 'ja', name: 'Japanese', native_name: '日本語' },\n  { code: 'zh', name: 'Chinese', native_name: '中文' },\n  { code: 'ko', name: 'Korean', native_name: '한국어' },\n  { code: 'ar', name: 'Arabic', native_name: 'العربية' },\n  { code: 'hi', name: 'Hindi', native_name: 'हिन्दी' },\n  { code: 'sv', name: 'Swedish', native_name: 'Svenska' },\n  { code: 'no', name: 'Norwegian', native_name: 'Norsk' },\n  { code: 'da', name: 'Danish', native_name: 'Dansk' },\n  { code: 'nl', name: 'Dutch', native_name: 'Nederlands' },\n  { code: 'fi', name: 'Finnish', native_name: 'Suomi' },\n  { code: 'pl', name: 'Polish', native_name: 'Polski' },\n  { code: 'tr', name: 'Turkish', native_name: 'Türkçe' },\n  { code: 'cs', name: 'Czech', native_name: 'Čeština' }\n]","import React, { useState, useRef } from 'react'\nimport { motion } from 'framer-motion'\nimport { X, Upload, FileText, Globe, AlertCircle, CheckCircle } from 'lucide-react'\nimport { subtitleApi } from '@/lib/subtitleApi'\nimport { COMMON_LANGUAGES, SUBTITLE_FORMATS } from '@/types/subtitles'\n\ninterface SubtitleUploadModalProps {\n  isOpen: boolean\n  onClose: () => void\n  mediaId: number\n  mediaTitle?: string\n  onUploadSuccess?: () => void\n}\n\nexport const SubtitleUploadModal: React.FC<SubtitleUploadModalProps> = ({\n  isOpen,\n  onClose,\n  mediaId,\n  mediaTitle,\n  onUploadSuccess\n}) => {\n  const [selectedFile, setSelectedFile] = useState<File | null>(null)\n  const [selectedLanguage, setSelectedLanguage] = useState('')\n  const [selectedFormat, setSelectedFormat] = useState('')\n  const [isUploading, setIsUploading] = useState(false)\n  const [uploadResult, setUploadResult] = useState<{ success: boolean; message: string } | null>(null)\n  const [dragActive, setDragActive] = useState(false)\n  \n  const fileInputRef = useRef<HTMLInputElement>(null)\n\n  const handleFileSelect = (file: File) => {\n    if (file && (file.name.endsWith('.srt') || file.name.endsWith('.vtt') || \n                 file.name.endsWith('.ass') || file.name.endsWith('.ssa') || \n                 file.name.endsWith('.sub'))) {\n      setSelectedFile(file)\n      \n      // Auto-detect format from file extension\n      const extension = file.name.split('.').pop()?.toLowerCase()\n      if (extension && SUBTITLE_FORMATS.includes(extension as any)) {\n        setSelectedFormat(extension)\n      }\n      \n      setUploadResult(null)\n    } else {\n      setUploadResult({\n        success: false,\n        message: 'Invalid file format. Please select a subtitle file (.srt, .vtt, .ass, .ssa, .sub)'\n      })\n    }\n  }\n\n  const handleDrop = (e: React.DragEvent) => {\n    e.preventDefault()\n    setDragActive(false)\n    \n    const files = e.dataTransfer.files\n    if (files.length > 0) {\n      handleFileSelect(files[0])\n    }\n  }\n\n  const handleDragOver = (e: React.DragEvent) => {\n    e.preventDefault()\n    setDragActive(true)\n  }\n\n  const handleDragLeave = (e: React.DragEvent) => {\n    e.preventDefault()\n    setDragActive(false)\n  }\n\n  const handleFileInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = e.target.files\n    if (files && files.length > 0) {\n      handleFileSelect(files[0])\n    }\n  }\n\n  const handleUpload = async () => {\n    if (!selectedFile || !selectedLanguage) {\n      setUploadResult({\n        success: false,\n        message: 'Please select a file and language'\n      })\n      return\n    }\n\n    setIsUploading(true)\n    try {\n      const result = await subtitleApi.uploadSubtitle(\n        mediaId,\n        selectedFile,\n        selectedLanguage,\n        selectedFormat || undefined\n      )\n      \n      if (result.success) {\n        setUploadResult({\n          success: true,\n          message: result.message || 'Subtitle uploaded successfully!'\n        })\n        onUploadSuccess?.()\n        \n        // Reset form after successful upload\n        setTimeout(() => {\n          setSelectedFile(null)\n          setSelectedLanguage('')\n          setSelectedFormat('')\n          setUploadResult(null)\n          if (fileInputRef.current) {\n            fileInputRef.current.value = ''\n          }\n        }, 2000)\n      } else {\n        setUploadResult({\n          success: false,\n          message: result.error || 'Upload failed'\n        })\n      }\n    } catch (error) {\n      setUploadResult({\n        success: false,\n        message: error instanceof Error ? error.message : 'Upload failed'\n      })\n    } finally {\n      setIsUploading(false)\n    }\n  }\n\n  const resetForm = () => {\n    setSelectedFile(null)\n    setSelectedLanguage('')\n    setSelectedFormat('')\n    setUploadResult(null)\n    if (fileInputRef.current) {\n      fileInputRef.current.value = ''\n    }\n  }\n\n  const formatFileSize = (bytes: number) => {\n    if (bytes === 0) return '0 Bytes'\n    const k = 1024\n    const sizes = ['Bytes', 'KB', 'MB', 'GB']\n    const i = Math.floor(Math.log(bytes) / Math.log(k))\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\n  }\n\n  if (!isOpen) return null\n\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      exit={{ opacity: 0 }}\n      className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\"\n      onClick={onClose}\n    >\n      <motion.div\n        initial={{ scale: 0.95, opacity: 0 }}\n        animate={{ scale: 1, opacity: 1 }}\n        exit={{ scale: 0.95, opacity: 0 }}\n        className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full p-6\"\n        onClick={(e) => e.stopPropagation()}\n      >\n        <div className=\"flex justify-between items-center mb-6\">\n          <h2 className=\"text-xl font-semibold flex items-center gap-2\">\n            <Upload className=\"w-5 h-5\" />\n            Upload Subtitle\n          </h2>\n          <button\n            onClick={onClose}\n            className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg\"\n          >\n            <X className=\"w-5 h-5\" />\n          </button>\n        </div>\n\n        {mediaTitle && (\n          <div className=\"mb-4 text-sm text-gray-600 dark:text-gray-400\">\n            Uploading for <span className=\"font-medium\">{mediaTitle}</span>\n          </div>\n        )}\n\n        {/* File Drop Area */}\n        <div\n          className={`border-2 border-dashed rounded-lg p-6 mb-4 transition-colors ${\n            dragActive \n              ? 'border-blue-400 bg-blue-50 dark:bg-blue-900/20' \n              : 'border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500'\n          }`}\n          onDrop={handleDrop}\n          onDragOver={handleDragOver}\n          onDragLeave={handleDragLeave}\n        >\n          <div className=\"text-center\">\n            <FileText className=\"w-12 h-12 mx-auto mb-3 text-gray-400\" />\n            <p className=\"text-gray-600 dark:text-gray-400 mb-2\">\n              Drag and drop your subtitle file here, or click to browse\n            </p>\n            <input\n              ref={fileInputRef}\n              type=\"file\"\n              accept=\".srt,.vtt,.ass,.ssa,.sub\"\n              onChange={handleFileInputChange}\n              className=\"hidden\"\n            />\n            <button\n              onClick={() => fileInputRef.current?.click()}\n              className=\"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600\"\n            >\n              Browse Files\n            </button>\n          </div>\n        </div>\n\n        {/* Selected File Info */}\n        {selectedFile && (\n          <motion.div\n            initial={{ opacity: 0, y: 10 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"bg-gray-50 dark:bg-gray-700 rounded-lg p-3 mb-4\"\n          >\n            <div className=\"flex items-center gap-3\">\n              <FileText className=\"w-8 h-8 text-blue-500\" />\n              <div className=\"flex-1\">\n                <div className=\"font-medium text-gray-900 dark:text-white\">\n                  {selectedFile.name}\n                </div>\n                <div className=\"text-sm text-gray-600 dark:text-gray-400\">\n                  {formatFileSize(selectedFile.size)}\n                </div>\n              </div>\n              <button\n                onClick={resetForm}\n                className=\"p-1 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200\"\n              >\n                <X className=\"w-4 h-4\" />\n              </button>\n            </div>\n          </motion.div>\n        )}\n\n        {/* Language Selection */}\n        <div className=\"mb-4\">\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n            <Globe className=\"w-4 h-4 inline mr-1\" />\n            Language\n          </label>\n          <select\n            value={selectedLanguage}\n            onChange={(e) => setSelectedLanguage(e.target.value)}\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n          >\n            <option value=\"\">Select language...</option>\n            {COMMON_LANGUAGES.map((lang) => (\n              <option key={lang.code} value={lang.code}>\n                {lang.native_name} ({lang.name})\n              </option>\n            ))}\n          </select>\n        </div>\n\n        {/* Format Selection */}\n        <div className=\"mb-6\">\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n            Format\n          </label>\n          <select\n            value={selectedFormat}\n            onChange={(e) => setSelectedFormat(e.target.value)}\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n          >\n            <option value=\"\">Auto-detect...</option>\n            {SUBTITLE_FORMATS.map((format) => (\n              <option key={format} value={format}>\n                {format.toUpperCase()}\n              </option>\n            ))}\n          </select>\n        </div>\n\n        {/* Upload Result */}\n        {uploadResult && (\n          <motion.div\n            initial={{ opacity: 0, y: 10 }}\n            animate={{ opacity: 1, y: 0 }}\n            className={`rounded-lg p-3 mb-6 flex items-center gap-3 ${\n              uploadResult.success\n                ? 'bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-200'\n                : 'bg-red-100 dark:bg-red-900/20 text-red-800 dark:text-red-200'\n            }`}\n          >\n            {uploadResult.success ? (\n              <CheckCircle className=\"w-5 h-5\" />\n            ) : (\n              <AlertCircle className=\"w-5 h-5\" />\n            )}\n            <span className=\"text-sm\">{uploadResult.message}</span>\n          </motion.div>\n        )}\n\n        {/* Actions */}\n        <div className=\"flex gap-3\">\n          <button\n            onClick={handleUpload}\n            disabled={isUploading || !selectedFile || !selectedLanguage}\n            className=\"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\n          >\n            {isUploading ? (\n              <>\n                <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                Uploading...\n              </>\n            ) : (\n              <>\n                <Upload className=\"w-4 h-4\" />\n                Upload Subtitle\n              </>\n            )}\n          </button>\n          <button\n            onClick={onClose}\n            className=\"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600\"\n          >\n            Cancel\n          </button>\n        </div>\n\n        <div className=\"mt-4 text-xs text-gray-500 dark:text-gray-500 text-center\">\n          Supported formats: SRT, VTT, ASS, SSA, SUB\n        </div>\n      </motion.div>\n    </motion.div>\n  )\n}","import React, { useState } from 'react'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { motion, AnimatePresence } from 'framer-motion'\nimport { Search, Download, Globe, Clock, CheckCircle, AlertCircle, Trash2, Eye, RefreshCw, Languages, Filter, Upload, Film, X } from 'lucide-react'\nimport { subtitleApi } from '@/lib/subtitleApi'\nimport { mediaApi } from '@/lib/mediaApi'\nimport { SubtitleSyncModal } from '@/components/subtitles/SubtitleSyncModal'\nimport { SubtitleUploadModal } from '@/components/subtitles/SubtitleUploadModal'\nimport type { \n  SubtitleSearchRequest, \n  SubtitleSearchResult, \n  SubtitleTrack, \n  SubtitleMediaInfo, \n  SupportedLanguage, \n  SupportedProvider \n} from '@/types/subtitles'\nimport type { MediaItem, MediaSearchRequest } from '@/types/media'\nimport { COMMON_LANGUAGES } from '@/types/subtitles'\n\nexport const SubtitleManager: React.FC = () => {\n  const [searchQuery, setSearchQuery] = useState('')\n  const [selectedLanguage, setSelectedLanguage] = useState('')\n  const [selectedProviders, setSelectedProviders] = useState<string[]>([])\n  const [showFilters, setShowFilters] = useState(false)\n  const [selectedMedia, setSelectedMedia] = useState<MediaItem | null>(null)\n  const [showSearchResults, setShowSearchResults] = useState(false)\n  const [showMediaSelector, setShowMediaSelector] = useState(false)\n  const [currentPage, setCurrentPage] = useState(1)\n  const [searchLimit, setSearchLimit] = useState(20)\n  const [syncModalOpen, setSyncModalOpen] = useState(false)\n  const [syncSubtitle, setSyncSubtitle] = useState<{ id: string; language: string } | null>(null)\n  const [uploadModalOpen, setUploadModalOpen] = useState(false)\n\n  const queryClient = useQueryClient()\n\n  // Get supported languages and providers\n  const { data: languages = COMMON_LANGUAGES } = useQuery({\n    queryKey: ['subtitle-languages'],\n    queryFn: () => subtitleApi.getSupportedLanguages(),\n  })\n\n  const { data: providers = [] } = useQuery({\n    queryKey: ['subtitle-providers'],\n    queryFn: () => subtitleApi.getSupportedProviders(),\n  })\n\n  // Search media for selection\n  const { data: mediaSearchResults, isLoading: isSearchingMedia } = useQuery({\n    queryKey: ['media-search', searchQuery, currentPage],\n    queryFn: () => {\n      const request: MediaSearchRequest = {\n        query: searchQuery || undefined,\n        limit: 10,\n        offset: (currentPage - 1) * 10,\n      }\n      return mediaApi.searchMedia(request)\n    },\n    enabled: showMediaSelector && searchQuery.length > 0,\n  })\n\n  // Search subtitles\n  const {\n    data: searchResults,\n    isLoading: isSearching,\n    mutate: searchSubtitles,\n  } = useMutation({\n    mutationFn: (params: SubtitleSearchRequest) => subtitleApi.searchSubtitles(params),\n    onSuccess: () => {\n      setShowSearchResults(true)\n    },\n  })\n\n  // Get media subtitles\n  const { data: mediaSubtitles, isLoading: isLoadingMediaSubtitles } = useQuery({\n    queryKey: ['media-subtitles', selectedMedia?.id],\n    queryFn: () => selectedMedia ? subtitleApi.getMediaSubtitles(selectedMedia.id) : null,\n    enabled: !!selectedMedia,\n  })\n\n  // Download subtitle\n  const downloadMutation = useMutation({\n    mutationFn: ({ id, mediaPath }: { id: string; mediaPath?: string }) =>\n      subtitleApi.downloadSubtitle({ id, media_path: mediaPath || selectedMedia?.directory_path }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['media-subtitles', selectedMedia?.id] })\n    },\n  })\n\n  // Delete subtitle\n  const deleteMutation = useMutation({\n    mutationFn: (subtitleId: string) => subtitleApi.deleteSubtitle(subtitleId),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['media-subtitles', selectedMedia?.id] })\n    },\n  })\n\n  // Handle media selection\n  const handleMediaSelect = (media: MediaItem) => {\n    setSelectedMedia(media)\n    setShowMediaSelector(false)\n    setSearchQuery('')\n  }\n\n  // Handle search\n  const handleSearch = () => {\n    if (!searchQuery.trim()) return\n\n    if (showMediaSelector) {\n      // Media search mode - handled by query\n      return\n    }\n\n    // Subtitle search mode\n    searchSubtitles({\n      query: searchQuery,\n      language: selectedLanguage,\n      media_path: selectedMedia?.directory_path,\n      title: selectedMedia?.title,\n      year: selectedMedia?.year,\n      providers: selectedProviders.length > 0 ? selectedProviders : undefined,\n      limit: searchLimit,\n      offset: (currentPage - 1) * searchLimit,\n    })\n  }\n\n  // Handle download\n  const handleDownload = (result: SubtitleSearchResult) => {\n    downloadMutation.mutate({ \n      id: result.id, \n      mediaPath: selectedMedia?.directory_path \n    })\n  }\n\n  // Handle delete\n  const handleDelete = (subtitleId: string) => {\n    if (confirm('Are you sure you want to delete this subtitle?')) {\n      deleteMutation.mutate(subtitleId)\n    }\n  }\n\n  // Handle sync verification\n  const handleSyncVerification = (subtitleId: string, language: string) => {\n    setSyncSubtitle({ id: subtitleId, language })\n    setSyncModalOpen(true)\n  }\n\n  // Handle upload success\n  const handleUploadSuccess = () => {\n    queryClient.invalidateQueries({ queryKey: ['media-subtitles', selectedMedia?.id] })\n  }\n\n  // Provider toggle\n  const toggleProvider = (provider: string) => {\n    setSelectedProviders(prev =>\n      prev.includes(provider)\n        ? prev.filter(p => p !== provider)\n        : [...prev, provider]\n    )\n  }\n\n  // Toggle search mode\n  const toggleSearchMode = () => {\n    setShowMediaSelector(!showMediaSelector)\n    setShowSearchResults(false)\n    setSearchQuery('')\n  }\n\n  return (\n    <div className=\"p-6 max-w-7xl mx-auto\">\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        className=\"mb-8\"\n      >\n        <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white mb-2\">\n          Subtitle Manager\n        </h1>\n        <p className=\"text-gray-600 dark:text-gray-400\">\n          Search, download, and manage subtitles for your media collection\n        </p>\n      </motion.div>\n\n      {/* Media Selection */}\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ delay: 0.1 }}\n        className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6\"\n      >\n        <div className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-xl font-semibold flex items-center gap-2\">\n            <Film className=\"w-5 h-5\" />\n            Selected Media\n          </h2>\n          <div className=\"flex gap-2\">\n            {selectedMedia && (\n              <button\n                onClick={() => setUploadModalOpen(true)}\n                className=\"px-4 py-2 bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded-lg hover:bg-green-200 dark:hover:bg-green-800 flex items-center gap-2\"\n              >\n                <Upload className=\"w-4 h-4\" />\n                Upload Subtitle\n              </button>\n            )}\n            <button\n              onClick={toggleSearchMode}\n              className=\"px-4 py-2 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-800 flex items-center gap-2\"\n            >\n              {selectedMedia ? 'Change Media' : 'Select Media'}\n            </button>\n          </div>\n        </div>\n\n        {selectedMedia ? (\n          <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n            <div className=\"flex items-start justify-between\">\n              <div>\n                <h3 className=\"font-medium text-gray-900 dark:text-white text-lg\">\n                  {selectedMedia.title}\n                </h3>\n                <div className=\"flex items-center gap-4 mt-1 text-sm text-gray-600 dark:text-gray-400\">\n                  <span>{selectedMedia.media_type}</span>\n                  {selectedMedia.year && <span>{selectedMedia.year}</span>}\n                  {selectedMedia.quality && <span>{selectedMedia.quality}</span>}\n                </div>\n                <p className=\"text-sm text-gray-500 dark:text-gray-500 mt-2 truncate\">\n                  {selectedMedia.directory_path}\n                </p>\n              </div>\n              <button\n                onClick={() => setSelectedMedia(null)}\n                className=\"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200\"\n              >\n                <X className=\"w-4 h-4\" />\n              </button>\n            </div>\n          </div>\n        ) : (\n          <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n            <Film className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n            <p>No media selected</p>\n            <p className=\"text-sm mt-1\">Select a media item to manage its subtitles</p>\n          </div>\n        )}\n      </motion.div>\n\n      {/* Media Selector */}\n      <AnimatePresence>\n        {showMediaSelector && (\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: 20 }}\n            className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6\"\n          >\n            <h2 className=\"text-xl font-semibold mb-4 flex items-center gap-2\">\n              <Search className=\"w-5 h-5\" />\n              Search for Media\n            </h2>\n\n            <div className=\"flex gap-3 mb-4\">\n              <input\n                type=\"text\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                placeholder=\"Search for movies, TV shows, etc...\"\n                className=\"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                onKeyPress={(e) => e.key === 'Enter' && searchQuery.trim() && setCurrentPage(1)}\n              />\n              <button\n                onClick={() => setShowMediaSelector(false)}\n                className=\"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600\"\n              >\n                Cancel\n              </button>\n            </div>\n\n            {mediaSearchResults && mediaSearchResults.items.length > 0 && (\n              <div className=\"space-y-2 max-h-64 overflow-y-auto\">\n                {mediaSearchResults.items.map((media) => (\n                  <div\n                    key={media.id}\n                    onClick={() => handleMediaSelect(media)}\n                    className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-3 hover:bg-gray-50 dark:hover:bg-gray-750 cursor-pointer transition-colors\"\n                  >\n                    <h4 className=\"font-medium text-gray-900 dark:text-white\">\n                      {media.title}\n                    </h4>\n                    <div className=\"flex items-center gap-3 mt-1 text-sm text-gray-600 dark:text-gray-400\">\n                      <span>{media.media_type}</span>\n                      {media.year && <span>{media.year}</span>}\n                      {media.quality && <span>{media.quality}</span>}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n\n            {isSearchingMedia && (\n              <div className=\"flex justify-center py-4\">\n                <RefreshCw className=\"w-6 h-6 animate-spin text-blue-600\" />\n              </div>\n            )}\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Subtitle Search Section */}\n      {!showMediaSelector && (\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.2 }}\n          className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6\"\n        >\n          <h2 className=\"text-xl font-semibold mb-4 flex items-center gap-2\">\n            <Search className=\"w-5 h-5\" />\n            Search Subtitles\n          </h2>\n\n          {/* Search Bar */}\n          <div className=\"flex gap-3 mb-4\">\n            <input\n              type=\"text\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              placeholder={selectedMedia ? `Search subtitles for \"${selectedMedia.title}\"...` : \"Search subtitles by title, filename, or keywords...\"}\n              className=\"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              onKeyPress={(e) => e.key === 'Enter' && handleSearch()}\n            />\n            \n            <button\n              onClick={() => setShowFilters(!showFilters)}\n              className=\"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 flex items-center gap-2\"\n            >\n              <Filter className=\"w-4 h-4\" />\n              Filters\n            </button>\n\n            <button\n              onClick={handleSearch}\n              disabled={isSearching || !searchQuery.trim()}\n              className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center gap-2\"\n            >\n              {isSearching ? (\n                <RefreshCw className=\"w-4 h-4 animate-spin\" />\n              ) : (\n                <Search className=\"w-4 h-4\" />\n              )}\n              Search\n            </button>\n          </div>\n\n          {/* Filters */}\n          <AnimatePresence>\n            {showFilters && (\n              <motion.div\n                initial={{ height: 0, opacity: 0 }}\n                animate={{ height: 'auto', opacity: 1 }}\n                exit={{ height: 0, opacity: 0 }}\n                transition={{ duration: 0.2 }}\n                className=\"border-t border-gray-200 dark:border-gray-700 pt-4\"\n              >\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {/* Language Selector */}\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      <Globe className=\"w-4 h-4 inline mr-1\" />\n                      Language\n                    </label>\n                    <select\n                      value={selectedLanguage}\n                      onChange={(e) => setSelectedLanguage(e.target.value)}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n                    >\n                      <option value=\"\">All Languages</option>\n                      {languages.map((lang) => (\n                        <option key={lang.code} value={lang.code}>\n                          {lang.native_name} ({lang.name})\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n\n                  {/* Provider Selector */}\n                  <div className=\"lg:col-span-2\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      Providers\n                    </label>\n                    <div className=\"flex flex-wrap gap-2\">\n                      {providers.map((provider) => (\n                        <button\n                          key={provider.name}\n                          onClick={() => toggleProvider(provider.name)}\n                          className={`px-3 py-1 rounded-full text-sm transition-colors ${\n                            selectedProviders.includes(provider.name)\n                              ? 'bg-blue-600 text-white'\n                              : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'\n                          } ${!provider.enabled ? 'opacity-50 cursor-not-allowed' : ''}`}\n                          disabled={!provider.enabled}\n                        >\n                          {provider.display_name}\n                        </button>\n                      ))}\n                    </div>\n                  </div>\n                </div>\n              </motion.div>\n            )}\n          </AnimatePresence>\n        </motion.div>\n      )}\n\n      {/* Search Results */}\n      <AnimatePresence>\n        {showSearchResults && searchResults && (\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: 20 }}\n            className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6\"\n          >\n            <div className=\"flex justify-between items-center mb-4\">\n              <h3 className=\"text-lg font-semibold\">\n                Search Results ({searchResults.total} found)\n              </h3>\n              <button\n                onClick={() => setShowSearchResults(false)}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200\"\n              >\n                ×\n              </button>\n            </div>\n\n            <div className=\"space-y-3 max-h-96 overflow-y-auto\">\n              {searchResults.results.map((result) => (\n                <motion.div\n                  key={result.id}\n                  initial={{ opacity: 0 }}\n                  animate={{ opacity: 1 }}\n                  className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors\"\n                >\n                  <div className=\"flex items-start justify-between\">\n                    <div className=\"flex-1\">\n                      <h4 className=\"font-medium text-gray-900 dark:text-white\">\n                        {result.title}\n                      </h4>\n                      <div className=\"flex items-center gap-4 mt-1 text-sm text-gray-600 dark:text-gray-400\">\n                        <span className=\"flex items-center gap-1\">\n                          <Globe className=\"w-3 h-3\" />\n                          {result.language_name}\n                        </span>\n                        <span className=\"flex items-center gap-1\">\n                          <Eye className=\"w-3 h-3\" />\n                          {result.provider}\n                        </span>\n                        {result.rating && (\n                          <span className=\"flex items-center gap-1\">\n                            <CheckCircle className=\"w-3 h-3\" />\n                            {result.rating}/10\n                          </span>\n                        )}\n                        {result.release && (\n                          <span>Release: {result.release}</span>\n                        )}\n                      </div>\n                      <div className=\"flex items-center gap-4 mt-2 text-xs text-gray-500 dark:text-gray-500\">\n                        {result.hearing_impaired && (\n                          <span className=\"px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded\">\n                            HI\n                          </span>\n                        )}\n                        {result.foreign_parts_only && (\n                          <span className=\"px-2 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 rounded\">\n                            Foreign Parts Only\n                          </span>\n                        )}\n                        {result.machine_translated && (\n                          <span className=\"px-2 py-1 bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200 rounded\">\n                            Machine Translated\n                          </span>\n                        )}\n                      </div>\n                    </div>\n                    <button\n                      onClick={() => handleDownload(result)}\n                      disabled={downloadMutation.isLoading}\n                      className=\"ml-4 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400 flex items-center gap-2\"\n                    >\n                      {downloadMutation.isLoading ? (\n                        <RefreshCw className=\"w-4 h-4 animate-spin\" />\n                      ) : (\n                        <Download className=\"w-4 h-4\" />\n                      )}\n                      Download\n                    </button>\n                  </div>\n                </motion.div>\n              ))}\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Media Subtitles Management */}\n      {selectedMedia && (\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.3 }}\n          className=\"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6\"\n        >\n          <h2 className=\"text-xl font-semibold mb-4 flex items-center gap-2\">\n            <Languages className=\"w-5 h-5\" />\n            Subtitles for &quot;{selectedMedia.title}&quot;\n          </h2>\n\n          {isLoadingMediaSubtitles ? (\n            <div className=\"flex justify-center py-8\">\n              <RefreshCw className=\"w-8 h-8 animate-spin text-blue-600\" />\n            </div>\n          ) : mediaSubtitles && mediaSubtitles.subtitles.length > 0 ? (\n            <div className=\"space-y-3\">\n              {mediaSubtitles.subtitles.map((subtitle) => (\n                <motion.div\n                  key={subtitle.id}\n                  initial={{ opacity: 0 }}\n                  animate={{ opacity: 1 }}\n                  className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\"\n                >\n                  <div className=\"flex items-start justify-between\">\n                    <div className=\"flex-1\">\n                      <h4 className=\"font-medium text-gray-900 dark:text-white\">\n                        {subtitle.language_name}\n                      </h4>\n                      <div className=\"flex items-center gap-4 mt-1 text-sm text-gray-600 dark:text-gray-400\">\n                        <span className=\"flex items-center gap-1\">\n                          <Globe className=\"w-3 h-3\" />\n                          {subtitle.provider}\n                        </span>\n                        <span className=\"flex items-center gap-1\">\n                          <Eye className=\"w-3 h-3\" />\n                          {subtitle.format} • {subtitle.encoding}\n                        </span>\n                        {subtitle.sync_offset !== undefined && (\n                          <span className=\"flex items-center gap-1\">\n                            <Clock className=\"w-3 h-3\" />\n                            Offset: {subtitle.sync_offset}ms\n                          </span>\n                        )}\n                        {subtitle.verified && (\n                          <span className=\"flex items-center gap-1 text-green-600\">\n                            <CheckCircle className=\"w-3 h-3\" />\n                            Verified\n                          </span>\n                        )}\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <button\n                        onClick={() => handleSyncVerification(subtitle.id, subtitle.language_name)}\n                        className=\"p-2 text-blue-600 hover:bg-blue-50 dark:hover:bg-gray-700 rounded\"\n                        title=\"Verify Sync\"\n                      >\n                        <CheckCircle className=\"w-4 h-4\" />\n                      </button>\n                      <button\n                        onClick={() => handleDelete(subtitle.id)}\n                        className=\"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-gray-700 rounded\"\n                        title=\"Delete\"\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </button>\n                    </div>\n                  </div>\n                </motion.div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n              <Languages className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n              <p>No subtitles found for this media item</p>\n              <p className=\"text-sm mt-1\">Search and download subtitles to get started</p>\n            </div>\n          )}\n        </motion.div>\n      )}\n\n      {/* Modals */}\n      <AnimatePresence>\n        {syncModalOpen && syncSubtitle && selectedMedia && (\n          <SubtitleSyncModal\n            isOpen={syncModalOpen}\n            onClose={() => setSyncModalOpen(false)}\n            subtitleId={syncSubtitle.id}\n            mediaId={selectedMedia.id}\n            subtitleLanguage={syncSubtitle.language}\n          />\n        )}\n      </AnimatePresence>\n\n      <AnimatePresence>\n        {uploadModalOpen && selectedMedia && (\n          <SubtitleUploadModal\n            isOpen={uploadModalOpen}\n            onClose={() => setUploadModalOpen(false)}\n            mediaId={selectedMedia.id}\n            mediaTitle={selectedMedia.title}\n            onUploadSuccess={handleUploadSuccess}\n          />\n        )}\n      </AnimatePresence>\n    </div>\n  )\n}"],"names":["subtitleApi","params","api","res","request","mediaId","subtitleId","data","file","language","format","formData","SubtitleSyncModal","isOpen","onClose","subtitleLanguage","isVerifying","setIsVerifying","useState","verificationResult","setVerificationResult","sampleDuration","setSampleDuration","sensitivity","setSensitivity","handleVerify","result","error","getStatusColor","status","getStatusIcon","jsx","CheckCircle","AlertCircle","motion","jsxs","e","Clock","X","Fragment","RefreshCw","Play","SUBTITLE_FORMATS","COMMON_LANGUAGES","SubtitleUploadModal","mediaTitle","onUploadSuccess","selectedFile","setSelectedFile","selectedLanguage","setSelectedLanguage","selectedFormat","setSelectedFormat","isUploading","setIsUploading","uploadResult","setUploadResult","dragActive","setDragActive","fileInputRef","useRef","handleFileSelect","extension","_a","handleDrop","files","handleDragOver","handleDragLeave","handleFileInputChange","handleUpload","resetForm","formatFileSize","bytes","k","sizes","i","Upload","FileText","Globe","lang","SubtitleManager","searchQuery","setSearchQuery","selectedProviders","setSelectedProviders","showFilters","setShowFilters","selectedMedia","setSelectedMedia","showSearchResults","setShowSearchResults","showMediaSelector","setShowMediaSelector","currentPage","setCurrentPage","searchLimit","setSearchLimit","syncModalOpen","setSyncModalOpen","syncSubtitle","setSyncSubtitle","uploadModalOpen","setUploadModalOpen","queryClient","useQueryClient","languages","useQuery","providers","mediaSearchResults","isSearchingMedia","mediaApi","searchResults","isSearching","searchSubtitles","useMutation","mediaSubtitles","isLoadingMediaSubtitles","downloadMutation","id","mediaPath","deleteMutation","handleMediaSelect","media","handleSearch","handleDownload","handleDelete","handleSyncVerification","handleUploadSuccess","toggleProvider","provider","prev","p","toggleSearchMode","Film","AnimatePresence","Search","Filter","Eye","Download","Languages","subtitle","Trash2"],"mappings":"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"}