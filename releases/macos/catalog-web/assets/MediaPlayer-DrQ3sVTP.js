import{j as e,B as r}from"./index-BzqIBI_1.js";import{r as s}from"./router-CYAiCCsK.js";import{C as D,a as H,b as X,d as Y}from"./Card-pVNkGvZm.js";import{q as F,aN as A,aa as G,aO as J,aT as K,ab as Q,aU as W,c as Z,aL as ee}from"./ui-DhyrEzjX.js";const ne=({media:v,subtitles:j=[],onProgress:o,onEnded:u,onError:m})=>{const[l,d]=s.useState(!1),[w,g]=s.useState(0),[N,L]=s.useState(0),[R,E]=s.useState(1),[c,b]=s.useState(!1),[p,$]=s.useState(!1),[C,S]=s.useState(""),[k,q]=s.useState(!1),[B,h]=s.useState(!0),a=s.useRef(null),x=s.useRef(null),i=s.useRef(),y=t=>{const n=Math.floor(t/60),f=Math.floor(t%60);return`${n.toString().padStart(2,"0")}:${f.toString().padStart(2,"0")}`},I=s.useCallback(()=>{a.current&&(l?a.current.pause():a.current.play(),d(!l))},[l]),P=s.useCallback(t=>{a.current&&(a.current.volume=t,E(t),b(t===0))},[]),U=s.useCallback(()=>{a.current&&(a.current.muted=!c,b(!c))},[c]),V=s.useCallback(()=>{x.current&&(p?document.exitFullscreen&&document.exitFullscreen():x.current.requestFullscreen&&x.current.requestFullscreen(),$(!p))},[p]),_=s.useCallback(t=>{if(!a.current)return;const n=parseFloat(t.target.value);a.current.currentTime=n,g(n)},[]),T=s.useCallback(t=>{a.current&&(a.current.currentTime+=t)},[]),O=s.useCallback(()=>{h(!0),i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{h(!1)},3e3)},[]);return s.useEffect(()=>{const t=a.current;if(!t)return;const n=()=>{g(t.currentTime),o==null||o(t.currentTime,t.duration)},f=()=>{L(t.duration)},M=()=>{d(!1),u==null||u()},z=()=>{m==null||m(new Error("Video playback failed"))};return t.addEventListener("timeupdate",n),t.addEventListener("loadedmetadata",f),t.addEventListener("ended",M),t.addEventListener("error",z),()=>{t.removeEventListener("timeupdate",n),t.removeEventListener("loadedmetadata",f),t.removeEventListener("ended",M),t.removeEventListener("error",z)}},[o,u,m]),s.useEffect(()=>(l?i.current=setTimeout(()=>{h(!1)},3e3):h(!0),()=>{i.current&&clearTimeout(i.current)}),[l]),e.jsxs(D,{className:"w-full max-w-4xl mx-auto",children:[e.jsx(H,{children:e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5"}),v.title||"Unknown Title"]})}),e.jsx(Y,{className:"p-0",children:e.jsxs("div",{ref:x,className:"relative bg-black aspect-video",onMouseMove:O,children:[e.jsxs("video",{ref:a,className:"absolute inset-0 w-full h-full",onPlay:()=>d(!0),onPause:()=>d(!1),children:[e.jsx("source",{src:v.directory_path,type:v.media_type}),"Your browser does not support the video tag."]}),B&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent pointer-events-none",children:e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 pointer-events-auto",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("input",{type:"range",min:"0",max:N||0,value:w,onChange:_,className:"w-full h-1 bg-white/30 rounded-lg appearance-none cursor-pointer slider"}),e.jsxs("div",{className:"flex justify-between text-xs text-white/80 mt-1",children:[e.jsx("span",{children:y(w)}),e.jsx("span",{children:y(N)})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>T(-10),className:"text-white hover:text-white/80",children:e.jsx(A,{className:"w-4 h-4"})}),e.jsx(r,{variant:"ghost",size:"sm",onClick:I,className:"text-white hover:text-white/80",children:l?e.jsx(G,{className:"w-6 h-6"}):e.jsx(F,{className:"w-6 h-6"})}),e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>T(10),className:"text-white hover:text-white/80",children:e.jsx(J,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(r,{variant:"ghost",size:"sm",onClick:U,className:"text-white hover:text-white/80",children:c?e.jsx(K,{className:"w-4 h-4"}):e.jsx(Q,{className:"w-4 h-4"})}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:c?0:R,onChange:t=>P(parseFloat(t.target.value)),className:"w-20 h-1 bg-white/30 rounded-lg appearance-none cursor-pointer"})]}),e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>q(!k),className:"text-white hover:text-white/80",children:e.jsx(W,{className:"w-4 h-4"})}),e.jsx(r,{variant:"ghost",size:"sm",className:"text-white hover:text-white/80",children:e.jsx(Z,{className:"w-4 h-4"})}),e.jsx(r,{variant:"ghost",size:"sm",onClick:V,className:"text-white hover:text-white/80",children:e.jsx(ee,{className:"w-4 h-4"})})]})]})]})}),k&&j.length>0&&e.jsxs("div",{className:"absolute top-4 right-4 bg-black/80 rounded-lg p-4 text-white max-w-xs",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Subtitles"}),e.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>S(""),className:`w-full justify-start text-left ${C===""?"bg-white/20":""}`,children:"Off"}),j.map(t=>e.jsx(r,{variant:"ghost",size:"sm",onClick:()=>S(t.id),className:`w-full justify-start text-left ${C===t.id?"bg-white/20":""}`,children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{children:t.language}),e.jsx("span",{className:"text-xs opacity-70",children:t.language_name||t.language})]})},t.id))]})]})]})})]})};export{ne as M};
//# sourceMappingURL=MediaPlayer-DrQ3sVTP.js.map
