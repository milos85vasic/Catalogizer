import{j as e,B as h,a as R,z as d}from"./index-BzqIBI_1.js";import{r as m}from"./router-CYAiCCsK.js";import{C as F,d as k,a as D,b as P}from"./Card-pVNkGvZm.js";import{B as A}from"./Badge-CeVT3Lft.js";import{P as Q}from"./Progress-DQYu3Ol9.js";import{I as N}from"./Input-DQaGiHGP.js";import{c as S,o as K,R as U,j as Z,C as H,X as G,y as X,z as V}from"./ui-DhyrEzjX.js";import"./charts-BaIhTcLh.js";import"./utils-B26ZFImD.js";const W=({jobs:n,supportedFormats:u,onStartConversion:g,onCancelConversion:x,onRetryConversion:j,onDownloadFile:f})=>{const[w,p]=m.useState(!1),[l,C]=m.useState(null),[i,a]=m.useState("mp4"),[r,M]=m.useState("medium"),[o,v]=m.useState({resolution:"",bitrate:"",framerate:"",audioCodec:"",videoCodec:""}),z={low:{resolution:"480p",bitrate:1e3,label:"Low (Fast)"},medium:{resolution:"720p",bitrate:2500,label:"Medium (Balanced)"},high:{resolution:"1080p",bitrate:5e3,label:"High (Quality)"},ultra:{resolution:"4K",bitrate:15e3,label:"Ultra (Best)"}},q=s=>{s.target.files&&s.target.files[0]&&C(s.target.files[0])},J=()=>{var c;if(!l)return;const s=z[r],t={sourceFile:{path:URL.createObjectURL(l),name:l.name,format:((c=l.name.split(".").pop())==null?void 0:c.toLowerCase())||"unknown",size:l.size},targetFormat:i,quality:r,options:{resolution:o.resolution||s.resolution,bitrate:o.bitrate?parseInt(o.bitrate):s.bitrate,framerate:o.framerate?parseInt(o.framerate):30,audioCodec:o.audioCodec||"aac",videoCodec:o.videoCodec||"h264"}};g==null||g(t),p(!1),C(null),v({resolution:"",bitrate:"",framerate:"",audioCodec:"",videoCodec:""})},B=s=>{if(s===0)return"0 Bytes";const t=1024,c=["Bytes","KB","MB","GB"],b=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,b)).toFixed(2))+" "+c[b]},E=(s,t)=>{if(!s||!t)return"---";const c=new Date(s),b=new Date(t),T=Math.round((b.getTime()-c.getTime())/1e3),L=Math.floor(T/60),O=T%60;return`${L}m ${O}s`},$=s=>{switch(s){case"completed":return e.jsx(V,{className:"w-5 h-5 text-green-500"});case"processing":return e.jsx(U,{className:"w-5 h-5 text-blue-500 animate-spin"});case"failed":return e.jsx(X,{className:"w-5 h-5 text-red-500"});case"cancelled":return e.jsx(G,{className:"w-5 h-5 text-gray-500"});default:return e.jsx(H,{className:"w-5 h-5 text-gray-400"})}},I=s=>{const t={pending:"secondary",processing:"default",completed:"default",failed:"destructive",cancelled:"outline"};return e.jsx(A,{variant:t[s],children:s.charAt(0).toUpperCase()+s.slice(1)})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Format Converter"}),e.jsxs(h,{onClick:()=>p(!0),children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"New Conversion"]})]}),e.jsx("div",{className:"space-y-4",children:n.map(s=>e.jsx(F,{children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"mt-1",children:$(s.status)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 truncate",children:s.sourceFile.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.sourceFile.format.toUpperCase()," → ",s.targetFormat.toUpperCase()," • ",s.quality]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[I(s.status),s.status==="completed"&&s.outputFile&&e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>f==null?void 0:f(s.outputFile),children:[e.jsx(K,{className:"w-4 h-4 mr-1"}),"Download"]}),s.status==="failed"&&e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>j==null?void 0:j(s.id),children:[e.jsx(U,{className:"w-4 h-4 mr-1"}),"Retry"]}),["pending","processing"].includes(s.status)&&e.jsx(h,{variant:"outline",size:"sm",onClick:()=>x==null?void 0:x(s.id),children:"Cancel"})]})]}),s.status==="processing"&&e.jsx(Q,{value:s.progress,className:"mb-3",showLabel:!0}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block font-medium",children:"File Size"}),B(s.sourceFile.size)]}),e.jsxs("div",{children:[e.jsx("span",{className:"block font-medium",children:"Duration"}),E(s.startTime,s.endTime)]}),e.jsxs("div",{children:[e.jsx("span",{className:"block font-medium",children:"Resolution"}),s.options.resolution]}),e.jsxs("div",{children:[e.jsx("span",{className:"block font-medium",children:"Bitrate"}),s.options.bitrate," kbps"]})]}),s.status==="failed"&&s.error&&e.jsx("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:s.error}),s.status==="completed"&&s.outputFile&&e.jsx("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg text-sm text-green-700",children:"Conversion completed successfully. File is ready for download."})]})]})})},s.id))}),n.length===0&&e.jsx(F,{className:"text-center py-12",children:e.jsx(k,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(S,{className:"w-8 h-8 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No conversion jobs"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Start your first media format conversion"}),e.jsxs(h,{onClick:()=>p(!0),children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Create Conversion Job"]})]})]})})}),w&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs(F,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(D,{children:e.jsx(P,{children:"Create Conversion Job"})}),e.jsxs(k,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select File"}),e.jsx("input",{type:"file",accept:"video/*,audio/*",onChange:q,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),l&&e.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",l.name," (",B(l.size),")"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Target Format"}),e.jsx("select",{value:i,onChange:s=>a(s.target.value),className:"w-full p-3 border border-gray-300 rounded-lg",children:u.map(s=>e.jsx("option",{value:s,children:s.toUpperCase()},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quality Preset"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(z).map(([s,t])=>e.jsxs("label",{className:`flex items-center p-3 border rounded-lg cursor-pointer transition-colors ${r===s?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("input",{type:"radio",name:"quality",value:s,checked:r===s,onChange:c=>M(c.target.value),className:"sr-only"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.label}),e.jsxs("div",{className:"text-sm text-gray-600",children:[t.resolution," • ",t.bitrate,"kbps"]})]})]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custom Options (Optional)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(N,{placeholder:"Resolution (e.g., 1080p)",value:o.resolution,onChange:s=>v(t=>({...t,resolution:s.target.value}))}),e.jsx(N,{placeholder:"Bitrate (kbps)",type:"number",value:o.bitrate,onChange:s=>v(t=>({...t,bitrate:s.target.value}))}),e.jsx(N,{placeholder:"Framerate (fps)",type:"number",value:o.framerate,onChange:s=>v(t=>({...t,framerate:s.target.value}))}),e.jsx(N,{placeholder:"Audio Codec (e.g., aac)",value:o.audioCodec,onChange:s=>v(t=>({...t,audioCodec:s.target.value}))})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(h,{variant:"outline",onClick:()=>p(!1),className:"flex-1",children:"Cancel"}),e.jsxs(h,{onClick:J,disabled:!l,className:"flex-1",children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Start Conversion"]})]})]})]})})]})},y={async getConversionJobs(){return[{id:"1",sourceFile:{path:"/media/movies/sample.mkv",name:"sample.mkv",format:"mkv",size:1073741824},targetFormat:"mp4",quality:"high",status:"completed",progress:100,startTime:"2023-12-09T10:00:00Z",endTime:"2023-12-09T10:15:00Z",outputFile:"/media/converted/sample.mp4",options:{resolution:"1080p",bitrate:5e3,framerate:30,audioCodec:"aac",videoCodec:"h264"}},{id:"2",sourceFile:{path:"/media/movies/another-video.avi",name:"another-video.avi",format:"avi",size:2147483648},targetFormat:"mp4",quality:"medium",status:"processing",progress:65,startTime:"2023-12-09T11:30:00Z",options:{resolution:"720p",bitrate:2500,framerate:30,audioCodec:"aac",videoCodec:"h264"}}]},async startConversion(n){return{...n,id:Date.now().toString(),status:"pending",progress:0}},async cancelConversion(n){},async retryConversion(n){},async downloadFile(n){}},oe=()=>{const[n,u]=m.useState([]),[g]=m.useState(["mp4","mkv","avi","mov","webm","mp3","wav","flac"]),{data:x,isLoading:j,refetch:f}=R({queryKey:["conversion-jobs"],queryFn:()=>y.getConversionJobs(),staleTime:1e3*60*2,refetchInterval:1e3*30});m.useEffect(()=>{x&&u(x)},[x]);const w=async i=>{try{const a=await y.startConversion(i);u(r=>[a,...r]),d.success("Conversion started successfully"),f()}catch(a){d.error(`Failed to start conversion: ${a instanceof Error?a.message:"Unknown error"}`)}},p=async i=>{try{await y.cancelConversion(i),u(a=>a.map(r=>r.id===i?{...r,status:"cancelled"}:r)),d.success("Conversion cancelled")}catch(a){d.error(`Failed to cancel conversion: ${a instanceof Error?a.message:"Unknown error"}`)}},l=async i=>{try{await y.retryConversion(i),u(a=>a.map(r=>r.id===i?{...r,status:"pending",progress:0}:r)),d.success("Conversion retry initiated")}catch(a){d.error(`Failed to retry conversion: ${a instanceof Error?a.message:"Unknown error"}`)}},C=async i=>{try{await y.downloadFile(i),d.success("File downloaded successfully")}catch(a){d.error(`Failed to download file: ${a instanceof Error?a.message:"Unknown error"}`)}};return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Format Converter"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Convert media files to different formats with customizable quality settings"})]}),e.jsx(W,{jobs:n,supportedFormats:g,onStartConversion:w,onCancelConversion:p,onRetryConversion:l,onDownloadFile:C})]})};export{oe as ConversionTools};
//# sourceMappingURL=ConversionTools-9f69Kl8o.js.map
