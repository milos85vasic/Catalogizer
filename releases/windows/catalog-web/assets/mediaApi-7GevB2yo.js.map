{"version":3,"file":"mediaApi-7GevB2yo.js","sources":["../../src/lib/mediaApi.ts"],"sourcesContent":["import api from './api'\nimport type {\n  MediaItem,\n  MediaSearchRequest,\n  MediaSearchResponse,\n  ExternalMetadata,\n  QualityInfo,\n  StorageRoot\n} from '@/types/media'\n\nexport const mediaApi = {\n  searchMedia: (params: MediaSearchRequest): Promise<MediaSearchResponse> =>\n    api.get('/media/search', { params }).then((res) => res.data),\n\n  getMediaById: (id: number): Promise<MediaItem> =>\n    api.get(`/media/${id}`).then((res) => res.data),\n\n  getMediaByPath: (path: string): Promise<MediaItem> =>\n    api.get('/media/by-path', { params: { path } }).then((res) => res.data),\n\n  analyzeDirectory: (path: string): Promise<{ message: string; analysis_id: string }> =>\n    api.post('/media/analyze', { directory_path: path }).then((res) => res.data),\n\n  getExternalMetadata: (mediaId: number): Promise<ExternalMetadata[]> =>\n    api.get(`/media/${mediaId}/metadata`).then((res) => res.data),\n\n  refreshMetadata: (mediaId: number): Promise<{ message: string }> =>\n    api.post(`/media/${mediaId}/refresh`).then((res) => res.data),\n\n  getQualityInfo: (mediaId: number): Promise<QualityInfo> =>\n    api.get(`/media/${mediaId}/quality`).then((res) => res.data),\n\n  getMediaStats: (): Promise<{\n    total_items: number\n    by_type: Record<string, number>\n    by_quality: Record<string, number>\n    total_size: number\n    recent_additions: number\n  }> =>\n    api.get('/media/stats').then((res) => res.data),\n\n  getRecentMedia: (limit = 10): Promise<MediaItem[]> =>\n    api.get('/media/recent', { params: { limit } }).then((res) => res.data),\n\n  getPopularMedia: (limit = 10): Promise<MediaItem[]> =>\n    api.get('/media/popular', { params: { limit } }).then((res) => res.data),\n\n  deleteMedia: (id: number): Promise<void> =>\n    api.delete(`/media/${id}`).then(() => {/* no content */}),\n\n  updateMedia: (id: number, data: Partial<MediaItem>): Promise<MediaItem> =>\n    api.put(`/media/${id}`, data).then((res) => res.data),\n\n  // Storage root management\n  getStorageRoots: (): Promise<StorageRoot[]> =>\n    api.get('/storage/roots').then((res) => res.data.data),\n\n  getStorageRoot: (id: number): Promise<StorageRoot> =>\n    api.get(`/storage/roots/${id}`).then((res) => res.data),\n\n  createStorageRoot: (data: Omit<StorageRoot, 'id' | 'created_at' | 'updated_at'>): Promise<StorageRoot> =>\n    api.post('/storage/roots', data).then((res) => res.data),\n\n  updateStorageRoot: (id: number, data: Partial<StorageRoot>): Promise<StorageRoot> =>\n    api.put(`/storage/roots/${id}`, data).then((res) => res.data),\n\n  deleteStorageRoot: (id: number): Promise<void> =>\n    api.delete(`/storage/roots/${id}`).then(() => {/* no content */}),\n\n  testStorageRoot: (id: number): Promise<{ success: boolean; message: string }> =>\n    api.post(`/storage/roots/${id}/test`).then((res) => res.data),\n\n  // Download media file\n  downloadMedia: async (media: MediaItem): Promise<void> => {\n    const response = await api.get(`/download`, {\n      params: {\n        path: media.directory_path,\n        storage: media.storage_root_name,\n      },\n      responseType: 'blob',\n    })\n\n    // Create a download link and trigger it\n    const url = window.URL.createObjectURL(new Blob([response.data]))\n    const link = document.createElement('a')\n    link.href = url\n\n    // Extract filename from path or use title\n    const filename = media.directory_path.split('/').pop() || `${media.title}.${media.media_type}`\n    link.setAttribute('download', filename)\n\n    document.body.appendChild(link)\n    link.click()\n\n    // Cleanup\n    link.parentNode?.removeChild(link)\n    window.URL.revokeObjectURL(url)\n  },\n}\n\nexport default mediaApi"],"names":["mediaApi","params","api","res","id","path","mediaId","limit","data","media","response","url","link","filename","_a"],"mappings":"wCAUO,MAAMA,EAAW,CACtB,YAAcC,GACZC,EAAI,IAAI,gBAAiB,CAAE,OAAAD,CAAA,CAAQ,EAAE,KAAME,GAAQA,EAAI,IAAI,EAE7D,aAAeC,GACbF,EAAI,IAAI,UAAUE,CAAE,EAAE,EAAE,KAAMD,GAAQA,EAAI,IAAI,EAEhD,eAAiBE,GACfH,EAAI,IAAI,iBAAkB,CAAE,OAAQ,CAAE,KAAAG,CAAA,EAAQ,EAAE,KAAMF,GAAQA,EAAI,IAAI,EAExE,iBAAmBE,GACjBH,EAAI,KAAK,iBAAkB,CAAE,eAAgBG,CAAA,CAAM,EAAE,KAAMF,GAAQA,EAAI,IAAI,EAE7E,oBAAsBG,GACpBJ,EAAI,IAAI,UAAUI,CAAO,WAAW,EAAE,KAAMH,GAAQA,EAAI,IAAI,EAE9D,gBAAkBG,GAChBJ,EAAI,KAAK,UAAUI,CAAO,UAAU,EAAE,KAAMH,GAAQA,EAAI,IAAI,EAE9D,eAAiBG,GACfJ,EAAI,IAAI,UAAUI,CAAO,UAAU,EAAE,KAAMH,GAAQA,EAAI,IAAI,EAE7D,cAAe,IAObD,EAAI,IAAI,cAAc,EAAE,KAAMC,GAAQA,EAAI,IAAI,EAEhD,eAAgB,CAACI,EAAQ,KACvBL,EAAI,IAAI,gBAAiB,CAAE,OAAQ,CAAE,MAAAK,CAAA,EAAS,EAAE,KAAMJ,GAAQA,EAAI,IAAI,EAExE,gBAAiB,CAACI,EAAQ,KACxBL,EAAI,IAAI,iBAAkB,CAAE,OAAQ,CAAE,MAAAK,CAAA,EAAS,EAAE,KAAMJ,GAAQA,EAAI,IAAI,EAEzE,YAAcC,GACZF,EAAI,OAAO,UAAUE,CAAE,EAAE,EAAE,KAAK,IAAM,CAAiB,CAAC,EAE1D,YAAa,CAACA,EAAYI,IACxBN,EAAI,IAAI,UAAUE,CAAE,GAAII,CAAI,EAAE,KAAML,GAAQA,EAAI,IAAI,EAGtD,gBAAiB,IACfD,EAAI,IAAI,gBAAgB,EAAE,KAAMC,GAAQA,EAAI,KAAK,IAAI,EAEvD,eAAiBC,GACfF,EAAI,IAAI,kBAAkBE,CAAE,EAAE,EAAE,KAAMD,GAAQA,EAAI,IAAI,EAExD,kBAAoBK,GAClBN,EAAI,KAAK,iBAAkBM,CAAI,EAAE,KAAML,GAAQA,EAAI,IAAI,EAEzD,kBAAmB,CAACC,EAAYI,IAC9BN,EAAI,IAAI,kBAAkBE,CAAE,GAAII,CAAI,EAAE,KAAML,GAAQA,EAAI,IAAI,EAE9D,kBAAoBC,GAClBF,EAAI,OAAO,kBAAkBE,CAAE,EAAE,EAAE,KAAK,IAAM,CAAiB,CAAC,EAElE,gBAAkBA,GAChBF,EAAI,KAAK,kBAAkBE,CAAE,OAAO,EAAE,KAAMD,GAAQA,EAAI,IAAI,EAG9D,cAAe,MAAOM,GAAoC,OACxD,MAAMC,EAAW,MAAMR,EAAI,IAAI,YAAa,CAC1C,OAAQ,CACN,KAAMO,EAAM,eACZ,QAASA,EAAM,iBAAA,EAEjB,aAAc,MAAA,CACf,EAGKE,EAAM,OAAO,IAAI,gBAAgB,IAAI,KAAK,CAACD,EAAS,IAAI,CAAC,CAAC,EAC1DE,EAAO,SAAS,cAAc,GAAG,EACvCA,EAAK,KAAOD,EAGZ,MAAME,EAAWJ,EAAM,eAAe,MAAM,GAAG,EAAE,IAAA,GAAS,GAAGA,EAAM,KAAK,IAAIA,EAAM,UAAU,GAC5FG,EAAK,aAAa,WAAYC,CAAQ,EAEtC,SAAS,KAAK,YAAYD,CAAI,EAC9BA,EAAK,MAAA,GAGLE,EAAAF,EAAK,aAAL,MAAAE,EAAiB,YAAYF,GAC7B,OAAO,IAAI,gBAAgBD,CAAG,CAChC,CACF"}