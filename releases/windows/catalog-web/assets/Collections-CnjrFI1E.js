const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CollectionTemplates-BKdhYM22.js","assets/index-BzqIBI_1.js","assets/router-CYAiCCsK.js","assets/charts-BaIhTcLh.js","assets/utils-B26ZFImD.js","assets/ui-DhyrEzjX.js","assets/index-Ds5LNM1U.css","assets/Input-DQaGiHGP.js","assets/Tabs-VczWTLgE.js","assets/Badge-CeVT3Lft.js","assets/AdvancedSearch-DdOS6g_3.js","assets/Card-pVNkGvZm.js","assets/AIMetadata-CNrDn82p.js","assets/CollectionAutomation-BimCuQMf.js","assets/ExternalIntegrations-gZ1Ms1Ab.js"])))=>i.map(i=>d[i]);
var Pa=Object.defineProperty;var Da=(t,a,s)=>a in t?Pa(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s;var Ie=(t,a,s)=>Da(t,typeof a!="symbol"?a+"":a,s);import{j as e,f as Re,B as v,n as j,b as Y,c as Dt,a as Ke,e as re,_ as se}from"./index-BzqIBI_1.js";import{r as n,R as fe}from"./router-CYAiCCsK.js";import{I as ce}from"./Input-DQaGiHGP.js";import{S as Z,T as Ea}from"./Tabs-VczWTLgE.js";import{Z as Ge,X as de,a1 as Oa,a2 as Ra,a3 as $a,A as ie,m as M,q as Me,a4 as za,h as Fa,H as Et,V as Le,v as at,u as je,C as Ae,r as pt,a5 as La,a6 as we,Y as ve,a7 as Ot,a8 as Rt,a9 as Te,w as be,aa as qa,ab as Ua,o as oe,ac as $t,f as ke,ad as pe,ae as Ba,af as zt,ag as Va,ah as Qa,c as $e,ai as Ha,G as ze,J as Ft,R as Ce,p as Ne,aj as We,n as Fe,ak as Lt,i as qt,al as Ka,am as Ga,an as Wa,g as st,ao as Ut,k as yt,T as Ja,a as Je,W as Ze,ap as Ye,aq as Za,E as Xe,ar as Ya,as as Xa,x as es,at as ts,au as as,av as ss,aw as ls,ax as rs,ay as is,az as ns,aA as cs,aB as bt,aC as os,D as ds,S as vt,L as ms,aD as xs,aE as ft,aF as hs}from"./ui-DhyrEzjX.js";import{C as W}from"./Card-pVNkGvZm.js";import{r as us}from"./charts-BaIhTcLh.js";import{A as gs,a as ps,b as ys,c as bs,d as vs,e as fs,f as js,g as ws,h as Ns}from"./AIMetadata-CNrDn82p.js";const ks=({label:t,value:a="",onChange:s,placeholder:l,rows:o=4,className:w="",disabled:p=!1,error:N})=>e.jsxs("div",{className:Re("mb-4",w),children:[t&&e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t}),e.jsx("textarea",{value:a,onChange:s,placeholder:l,rows:o,disabled:p,className:Re("w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent","bg-white dark:bg-gray-800 text-gray-900 dark:text-white","resize-none",p&&"opacity-50 cursor-not-allowed",N&&"border-red-500 focus:ring-red-500",w)}),N&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:N})]}),G=({checked:t=!1,onCheckedChange:a,disabled:s=!1,className:l=""})=>{const o=()=>{!s&&a&&a(!t)};return e.jsx("button",{type:"button",role:"switch","aria-checked":t,disabled:s,onClick:o,className:Re("relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",t?"bg-blue-600 dark:bg-blue-500":"bg-gray-200 dark:bg-gray-700",s&&"opacity-50 cursor-not-allowed",l),children:e.jsx("span",{className:Re("inline-block h-4 w-4 transform rounded-full bg-white transition-transform",t?"translate-x-6":"translate-x-1")})})},lt=[{value:"title",label:"Title",type:"text"},{value:"artist",label:"Artist",type:"text"},{value:"album",label:"Album",type:"text"},{value:"genre",label:"Genre",type:"select"},{value:"year",label:"Year",type:"number"},{value:"decade",label:"Decade",type:"select"},{value:"duration",label:"Duration",type:"number"},{value:"file_size",label:"File Size",type:"number"},{value:"media_type",label:"Media Type",type:"select"},{value:"quality",label:"Quality",type:"select"},{value:"rating",label:"Rating",type:"number"},{value:"play_count",label:"Play Count",type:"number"},{value:"last_played",label:"Last Played",type:"date"},{value:"date_added",label:"Date Added",type:"date"},{value:"date_modified",label:"Date Modified",type:"date"},{value:"file_extension",label:"File Extension",type:"text"},{value:"bitrate",label:"Bitrate",type:"number"},{value:"resolution",label:"Resolution",type:"select"},{value:"fps",label:"Frame Rate",type:"number"},{value:"channels",label:"Audio Channels",type:"number"},{value:"language",label:"Language",type:"select"},{value:"subtitles",label:"Has Subtitles",type:"boolean"},{value:"is_favorite",label:"Is Favorite",type:"boolean"},{value:"tags",label:"Tags",type:"multiselect"}],Cs={text:[{value:"contains",label:"contains"},{value:"equals",label:"equals"},{value:"starts_with",label:"starts with"},{value:"ends_with",label:"ends with"},{value:"not_contains",label:"does not contain"},{value:"not_equals",label:"does not equal"},{value:"is_empty",label:"is empty"},{value:"is_not_empty",label:"is not empty"}],number:[{value:"equals",label:"equals"},{value:"not_equals",label:"does not equal"},{value:"greater_than",label:"greater than"},{value:"less_than",label:"less than"},{value:"greater_or_equal",label:"greater than or equal to"},{value:"less_or_equal",label:"less than or equal to"},{value:"between",label:"between"},{value:"not_between",label:"not between"},{value:"is_empty",label:"is empty"},{value:"is_not_empty",label:"is not empty"}],date:[{value:"equals",label:"equals"},{value:"not_equals",label:"does not equal"},{value:"after",label:"after"},{value:"before",label:"before"},{value:"between",label:"between"},{value:"not_between",label:"not between"},{value:"today",label:"is today"},{value:"yesterday",label:"is yesterday"},{value:"this_week",label:"is this week"},{value:"this_month",label:"is this month"},{value:"this_year",label:"is this year"},{value:"last_7_days",label:"in last 7 days"},{value:"last_30_days",label:"in last 30 days"},{value:"last_90_days",label:"in last 90 days"}],select:[{value:"equals",label:"equals"},{value:"not_equals",label:"does not equal"},{value:"is_any",label:"is any of"},{value:"is_not_any",label:"is not any of"},{value:"is_empty",label:"is empty"},{value:"is_not_empty",label:"is not empty"}],multiselect:[{value:"contains_all",label:"contains all"},{value:"contains_any",label:"contains any"},{value:"contains_none",label:"contains none"},{value:"is_empty",label:"is empty"},{value:"is_not_empty",label:"is not empty"}],boolean:[{value:"is_true",label:"is true"},{value:"is_false",label:"is false"}]},_s=[{value:"music",label:"Music"},{value:"video",label:"Video"},{value:"image",label:"Image"},{value:"document",label:"Document"}],Ss=[{value:"sd",label:"SD (Standard Definition)"},{value:"hd",label:"HD (High Definition)"},{value:"fhd",label:"FHD (Full HD)"},{value:"uhd",label:"UHD (4K)"},{value:"8k",label:"8K"}],Is=[{value:"rock",label:"Rock"},{value:"pop",label:"Pop"},{value:"jazz",label:"Jazz"},{value:"classical",label:"Classical"},{value:"electronic",label:"Electronic"},{value:"hip_hop",label:"Hip Hop"},{value:"country",label:"Country"},{value:"blues",label:"Blues"},{value:"reggae",label:"Reggae"},{value:"metal",label:"Metal"}],As=[{value:"1950s",label:"1950s"},{value:"1960s",label:"1960s"},{value:"1970s",label:"1970s"},{value:"1980s",label:"1980s"},{value:"1990s",label:"1990s"},{value:"2000s",label:"2000s"},{value:"2010s",label:"2010s"},{value:"2020s",label:"2020s"}],Ts=[{value:"480p",label:"480p"},{value:"720p",label:"720p"},{value:"1080p",label:"1080p"},{value:"1440p",label:"1440p"},{value:"2160p",label:"2160p (4K)"},{value:"4320p",label:"4320p (8K)"}],Ms=[{value:"en",label:"English"},{value:"es",label:"Spanish"},{value:"fr",label:"French"},{value:"de",label:"German"},{value:"it",label:"Italian"},{value:"pt",label:"Portuguese"},{value:"ru",label:"Russian"},{value:"ja",label:"Japanese"},{value:"zh",label:"Chinese"},{value:"ko",label:"Korean"}],Ps=[{id:"recently_added",name:"Recently Added",description:"Items added in the last 30 days",category:"Time-based",rules:[{field:"date_added",operator:"last_30_days",value:null,field_type:"date",label:"Date Added"}],icon:"Clock"},{id:"high_rated",name:"High Rated",description:"Items with rating 4 stars or higher",category:"Quality-based",rules:[{field:"rating",operator:"greater_or_equal",value:4,field_type:"number",label:"Rating"}],icon:"Star"},{id:"hd_movies",name:"HD Movies",description:"High definition video content",category:"Quality-based",rules:[{field:"media_type",operator:"equals",value:"video",field_type:"select",label:"Media Type"},{field:"quality",operator:"is_any",value:["hd","fhd","uhd","8k"],field_type:"select",label:"Quality",condition:"AND"}],icon:"Film"},{id:"music_classics",name:"Music Classics",description:"Classic music from before the year 2000",category:"Genre-based",rules:[{field:"media_type",operator:"equals",value:"music",field_type:"select",label:"Media Type"},{field:"year",operator:"less_than",value:2e3,field_type:"number",label:"Year",condition:"AND"}],icon:"Music"},{id:"favorites",name:"My Favorites",description:"All items marked as favorites",category:"Personal",rules:[{field:"is_favorite",operator:"is_true",value:null,field_type:"boolean",label:"Is Favorite"}],icon:"Heart"},{id:"large_files",name:"Large Files",description:"Files larger than 1GB",category:"Size-based",rules:[{field:"file_size",operator:"greater_than",value:1073741824,field_type:"number",label:"File Size"}],icon:"HardDrive"},{id:"rock_music",name:"Rock Music Collection",description:"All rock music tracks",category:"Genre-based",rules:[{field:"media_type",operator:"equals",value:"music",field_type:"select",label:"Media Type"},{field:"genre",operator:"equals",value:"rock",field_type:"select",label:"Genre",condition:"AND"}],icon:"Guitar"},{id:"recently_played",name:"Recently Played",description:"Items played in the last 7 days",category:"Activity-based",rules:[{field:"last_played",operator:"last_7_days",value:null,field_type:"date",label:"Last Played"}],icon:"Play"}],Ds=t=>{switch(t){case"media_type":return _s;case"quality":return Ss;case"genre":return Is;case"decade":return As;case"resolution":return Ts;case"language":return Ms;case"tags":return[{value:"favorite",label:"Favorite"},{value:"downloaded",label:"Downloaded"},{value:"watched",label:"Watched"},{value:"listened",label:"Listened"}];default:return[]}},Es=t=>{const a=lt.find(s=>s.value===t);return(a==null?void 0:a.label)||t},et=t=>{const a=lt.find(s=>s.value===t);return(a==null?void 0:a.type)||"text"},Os=t=>{const a=[];t.field||a.push("Field is required"),t.operator||a.push("Operator is required");const s=et(t.field);return t.operator!=="is_empty"&&t.operator!=="is_not_empty"&&t.operator!=="is_true"&&t.operator!=="is_false"&&t.operator!=="today"&&t.operator!=="yesterday"&&t.operator!=="this_week"&&t.operator!=="this_month"&&t.operator!=="this_year"&&t.operator!=="last_7_days"&&t.operator!=="last_30_days"&&t.operator!=="last_90_days"&&(t.value===null||t.value===void 0||t.value==="")&&a.push("Value is required for this operator"),s==="number"&&t.value!==null&&t.value!==void 0&&isNaN(Number(t.value))&&a.push("Value must be a number"),s==="date"&&t.value!==null&&t.value!==void 0&&(t.operator==="between"||t.operator==="not_between"?!Array.isArray(t.value)||t.value.length!==2?a.push("Date range must have 2 values"):t.value.some(l=>isNaN(Date.parse(l)))&&a.push("Invalid date format in range"):t.operator!=="today"&&t.operator!=="yesterday"&&t.operator!=="this_week"&&t.operator!=="this_month"&&t.operator!=="this_year"&&t.operator!=="last_7_days"&&t.operator!=="last_30_days"&&t.operator!=="last_90_days"&&isNaN(Date.parse(t.value))&&a.push("Invalid date format")),a},Rs=t=>{const a=[];return t.length===0?(a.push("At least one rule is required"),a):(t.forEach((s,l)=>{const o=Os(s);o.length>0&&a.push(`Rule ${l+1}: ${o.join(", ")}`)}),a)},jt={music:Le,video:at,image:Ot,document:ve},$s={Clock:Ae,Star:je,Film:at,Music:Le,Heart:Et,HardDrive:Fa,Guitar:za,Play:Me},Bt=({initialName:t="",initialDescription:a="",initialRules:s=[],onSave:l,onCancel:o,className:w=""})=>{const[p,N]=n.useState(t),[_,A]=n.useState(a),[k,L]=n.useState(s),[b,D]=n.useState(new Set),[S,r]=n.useState(!1),[c,C]=n.useState(!1),[y,$]=n.useState(null),[H,O]=n.useState(!1),z=()=>`rule_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;n.useEffect(()=>{k.length===0&&V()},[]);const V=(i,u)=>{const T={id:z(),field:"title",operator:"contains",value:"",field_type:"text",label:"Title"};L(i?d=>d.map(h=>h.id===i?{...h,nested_rules:[...h.nested_rules||[],T]}:h):d=>[...d,T])},F=i=>{L(u=>{const T=d=>d.filter(h=>h.id!==i).map(h=>({...h,nested_rules:h.nested_rules?T(h.nested_rules):void 0}));return T(u)})},E=(i,u)=>{L(T=>{const d=h=>h.map(I=>{if(I.id===i){const R=et(u.field||I.field),ne=["text","number","date","boolean","select","multiselect"].includes(R)?R:"text",g={field:I.field,operator:I.operator,value:I.value,condition:I.condition,nested_rules:I.nested_rules,label:I.label,id:I.id,field_type:ne,...u};return u.field&&(g.field_type=ne,g.label=Es(u.field)),g}return I.nested_rules?{...I,nested_rules:d(I.nested_rules)}:I});return d(T)})},x=i=>{const u=i.rules.map(T=>{const d=["text","number","date","boolean","select","multiselect"].includes(T.field_type)?T.field_type:"text";return{field:T.field,operator:T.operator,value:T.value,condition:T.condition,nested_rules:T.nested_rules,label:T.label,id:z(),field_type:d}});L(u),N(i.name),A(i.description),r(!1),j.success(`Loaded template: ${i.name}`)},f=i=>{const u=k.find(T=>T.id===i);if(u){const T=k.findIndex(I=>I.id===i),d={...u,id:z()},h=[...k];h.splice(T+1,0,d),L(h)}},P=async()=>{O(!0),$(null);try{await new Promise(i=>setTimeout(i,1500)),$({total_items:1234,matched_items:87,sample_items:[{id:"1",title:"Sample Song 1",artist:"Artist A",media_type:"music"},{id:"2",title:"Sample Movie 1",director:"Director B",media_type:"video"},{id:"3",title:"Sample Image 1",filename:"image.jpg",media_type:"image"}],performance_ms:245}),j.success("Rules tested successfully")}catch{j.error("Failed to test rules")}finally{O(!1)}},q=()=>{const i=Rs(k);if(i.length>0){j.error(i[0]);return}if(!p.trim()){j.error("Collection name is required");return}l(p.trim(),_.trim(),k)},Q=(i,u=0,T)=>{b.has(i.id);const d=et(i.field),h=Cs[d]||[],I=Ds(i.field);return e.jsxs(M.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:`border border-gray-200 dark:border-gray-700 rounded-lg p-4 mb-3 ${u>0?"ml-6 border-l-4 border-l-blue-500":""}`,children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex items-center justify-center mt-2",children:e.jsx("div",{className:"w-4 h-4 bg-gray-300 dark:bg-gray-600 rounded cursor-move"})}),e.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-4 gap-3",children:[e.jsx(Z,{value:i.field,onChange:R=>E(i.id,{field:R}),options:lt,className:"w-full"}),e.jsx(Z,{value:i.operator,onChange:R=>E(i.id,{operator:R}),options:h,className:"w-full"}),e.jsx("div",{className:"relative",children:d==="boolean"?e.jsx(G,{checked:i.value===!0,onCheckedChange:R=>E(i.id,{value:R})}):I.length>0?e.jsx(Z,{value:Array.isArray(i.value)?i.value[0]:i.value,onChange:R=>E(i.id,{value:i.operator==="is_any"||i.operator==="is_not_any"?[R]:R}),options:I,className:"w-full"}):e.jsx(ce,{value:i.value||"",onChange:R=>E(i.id,{value:R.target.value}),placeholder:"Enter value",type:d==="number"?"number":d==="date"?"date":"text",className:"w-full"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>f(i.id),title:"Duplicate rule",children:e.jsx(Te,{className:"w-4 h-4"})}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>V(i.id),title:"Add nested rule",children:e.jsx(we,{className:"w-4 h-4"})}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>F(i.id),title:"Remove rule",className:"text-red-600 hover:text-red-700",children:e.jsx(be,{className:"w-4 h-4"})})]})]})]}),i.nested_rules&&i.nested_rules.length>0&&e.jsx("div",{className:"mt-3 border-t border-gray-200 dark:border-gray-700 pt-3",children:i.nested_rules.map(R=>Q(R,u+1))})]},i.id)};return e.jsxs("div",{className:`bg-white dark:bg-gray-900 rounded-lg shadow-lg ${w}`,children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg flex items-center justify-center",children:e.jsx(Ge,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Smart Collection Builder"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Create collections that automatically update based on rules"})]})]}),e.jsx(v,{variant:"ghost",size:"sm",onClick:o,children:e.jsx(de,{className:"w-4 h-4"})})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(ce,{label:"Collection Name",value:p,onChange:i=>N(i.target.value),placeholder:"Enter collection name",className:"mb-4"}),e.jsx(ks,{label:"Description",value:_,onChange:i=>A(i.target.value),placeholder:"Optional description for this collection",rows:3,className:"mb-4"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(Oa,{className:"w-5 h-5 text-yellow-500"}),"Quick Start Templates"]}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>r(!S),children:S?e.jsx(Ra,{className:"w-4 h-4"}):e.jsx($a,{className:"w-4 h-4"})})]}),e.jsx(ie,{children:S&&e.jsx(M.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Ps.map(i=>{const u=$s[i.icon||"Star"];return e.jsxs(M.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800",onClick:()=>x(i),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center",children:u&&e.jsx(u,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white text-sm",children:i.name}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:i.category})]})]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:i.description})]},i.id)})})})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(pt,{className:"w-5 h-5"}),"Collection Rules"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(v,{variant:"ghost",size:"sm",onClick:P,disabled:H,className:"flex items-center gap-2",children:[e.jsx(La,{className:"w-4 h-4"}),H?"Testing...":"Test Rules"]}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>V(),children:[e.jsx(we,{className:"w-4 h-4 mr-1"}),"Add Rule"]})]})]}),e.jsx(ie,{children:k.map(i=>Q(i))}),k.length===0&&e.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[e.jsx(pt,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-3",children:"No rules defined yet. Start by adding a rule above."}),e.jsxs(v,{variant:"outline",onClick:()=>V(),children:[e.jsx(we,{className:"w-4 h-4 mr-1"}),"Add First Rule"]})]})]}),y&&e.jsxs(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-6 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-green-800 dark:text-green-200 mb-3",children:"Test Results"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:"Total Items"}),e.jsx("p",{className:"text-lg font-bold text-green-800 dark:text-green-200",children:y.total_items.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:"Matched Items"}),e.jsx("p",{className:"text-lg font-bold text-green-800 dark:text-green-200",children:y.matched_items.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:"Match Rate"}),e.jsxs("p",{className:"text-lg font-bold text-green-800 dark:text-green-200",children:[(y.matched_items/y.total_items*100).toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:"Performance"}),e.jsxs("p",{className:"text-lg font-bold text-green-800 dark:text-green-200",children:[y.performance_ms,"ms"]})]})]}),y.sample_items&&y.sample_items.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 mb-2",children:"Sample Items:"}),e.jsx("div",{className:"space-y-1",children:y.sample_items.map(i=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[jt[i.media_type]&&fe.createElement(jt[i.media_type],{className:"w-4 h-4"}),e.jsx("span",{className:"text-green-800 dark:text-green-200",children:i.title}),i.artist&&e.jsxs("span",{className:"text-green-600 dark:text-green-400",children:["by ",i.artist]})]},i.id))})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Advanced options"}),e.jsx(G,{checked:c,onCheckedChange:C})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{variant:"ghost",onClick:o,children:"Cancel"}),e.jsxs(v,{onClick:q,className:"flex items-center gap-2",children:[e.jsx(Rt,{className:"w-4 h-4"}),"Create Collection"]})]})]}),e.jsx(ie,{children:c&&e.jsxs(M.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Advanced Options"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Auto-refresh frequency"}),e.jsx(Z,{value:"daily",onChange:()=>{},options:[{value:"hourly",label:"Hourly"},{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"manual",label:"Manual only"}],className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sort order"}),e.jsx(Z,{value:"date_added",onChange:()=>{},options:[{value:"date_added",label:"Date Added"},{value:"title",label:"Title"},{value:"artist",label:"Artist"},{value:"rating",label:"Rating"},{value:"play_count",label:"Play Count"}],className:"w-full"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Maximum items (0 = unlimited)"}),e.jsx(ce,{type:"number",value:"0",onChange:()=>{},placeholder:"0",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Cache results"}),e.jsx(G,{checked:!0,onCheckedChange:()=>{}}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Improve performance by caching query results"})]})]})]})]})})]})]})},Vt=Object.freeze(Object.defineProperty({__proto__:null,SmartCollectionBuilder:Bt},Symbol.toStringTag,{value:"Module"})),he=[{id:"1",name:"My Music Collection",description:"All my favorite music tracks organized by genre and artist",item_count:1250,is_public:!1,is_smart:!1,primary_media_type:"music",created_at:"2024-01-15T10:00:00Z",updated_at:"2024-01-20T15:30:00Z",thumbnail_url:"/collections/music-thumb.jpg",owner_id:"user1"},{id:"2",name:"Movie Favorites",description:"Best movies in my collection",item_count:87,is_public:!0,is_smart:!1,primary_media_type:"video",created_at:"2024-01-10T09:00:00Z",updated_at:"2024-01-18T20:15:00Z",thumbnail_url:"/collections/movies-thumb.jpg",owner_id:"user1"},{id:"3",name:"Recently Added",description:"Items added in the last 30 days",item_count:45,is_public:!1,is_smart:!0,primary_media_type:"mixed",created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-20T18:45:00Z",owner_id:"user1"}],ue=[{id:"3",name:"Recently Added",description:"Items added in the last 30 days",is_smart:!0,smart_rules:[{id:"rule1",field:"date_added",operator:"last_30_days",value:null,field_type:"date",label:"Date Added"}],item_count:45,last_updated:"2024-01-20T18:45:00Z",created_at:"2024-01-01T00:00:00Z",updated_at:"2024-01-20T18:45:00Z",thumbnail_url:"/collections/recent-thumb.jpg",owner_id:"user1",is_public:!1,primary_media_type:"mixed"},{id:"4",name:"High Rated Movies",description:"Movies with rating 4 stars or higher",is_smart:!0,smart_rules:[{id:"rule1",field:"media_type",operator:"equals",value:"video",field_type:"select",label:"Media Type",condition:"AND"},{id:"rule2",field:"rating",operator:"greater_or_equal",value:4,field_type:"number",label:"Rating",condition:"AND"}],item_count:23,last_updated:"2024-01-19T22:30:00Z",created_at:"2024-01-05T12:00:00Z",updated_at:"2024-01-19T22:30:00Z",thumbnail_url:"/collections/high-rated-thumb.jpg",owner_id:"user1",is_public:!0,primary_media_type:"video"}],zs=[{id:"recently_added",name:"Recently Added",description:"Items added in the last 30 days",category:"Time-based",rules:[{field:"date_added",operator:"last_30_days",value:null,field_type:"date",label:"Date Added"}],icon:"Clock"},{id:"high_rated",name:"High Rated",description:"Items with rating 4 stars or higher",category:"Quality-based",rules:[{field:"rating",operator:"greater_or_equal",value:4,field_type:"number",label:"Rating"}],icon:"Star"}],Fs=[{collection_id:"1",total_items:1250,media_type_distribution:{music:1250,video:0,image:0,document:0},size_distribution:{total_size_bytes:5368709120,average_size_bytes:4294967,largest_item_size_bytes:52428800},quality_distribution:{hd:0,sd:1250,uhd:0},time_based_stats:{items_added_today:5,items_added_this_week:25,items_added_this_month:68,oldest_item_date:"2023-01-15T10:00:00Z",newest_item_date:"2024-01-20T15:30:00Z"},engagement_stats:{total_views:3420,unique_viewers:45,total_plays:2890,average_completion_rate:.78,last_accessed:"2024-01-20T18:45:00Z"},genre_distribution:{Rock:450,Pop:320,Jazz:280,Electronic:200}}],X={getCollections:async()=>(await new Promise(t=>setTimeout(t,100)),he),getCollection:async t=>{await new Promise(s=>setTimeout(s,100));const a=he.find(s=>s.id===t);if(!a)throw new Error("Collection not found");return a},createCollection:async t=>{var s;await new Promise(l=>setTimeout(l,200));const a={id:Date.now().toString(),name:t.name,description:t.description,item_count:((s=t.items)==null?void 0:s.length)||0,is_public:!1,is_smart:!1,primary_media_type:"mixed",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),owner_id:"user1"};return he.push(a),a},updateCollection:async(t,a)=>{await new Promise(l=>setTimeout(l,200));const s=he.findIndex(l=>l.id===t);if(s===-1)throw new Error("Collection not found");return he[s]={...he[s],...a,updated_at:new Date().toISOString()},he[s]},deleteCollection:async t=>{await new Promise(s=>setTimeout(s,200));const a=he.findIndex(s=>s.id===t);if(a===-1)throw new Error("Collection not found");he.splice(a,1)},getSmartCollections:async()=>(await new Promise(t=>setTimeout(t,100)),ue),getSmartCollection:async t=>{await new Promise(s=>setTimeout(s,100));const a=ue.find(s=>s.id===t);if(!a)throw new Error("Smart Collection not found");return a},createSmartCollection:async t=>{await new Promise(s=>setTimeout(s,300));const a={id:Date.now().toString(),name:t.name,description:t.description,is_smart:!0,smart_rules:t.rules,item_count:Math.floor(Math.random()*100)+10,last_updated:new Date().toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString(),owner_id:"user1",is_public:!1,primary_media_type:"mixed"};return ue.push(a),a},updateSmartCollection:async(t,a)=>{await new Promise(l=>setTimeout(l,200));const s=ue.findIndex(l=>l.id===t);if(s===-1)throw new Error("Smart Collection not found");return ue[s]={...ue[s],...a,updated_at:new Date().toISOString()},ue[s]},deleteSmartCollection:async t=>{await new Promise(s=>setTimeout(s,200));const a=ue.findIndex(s=>s.id===t);if(a===-1)throw new Error("Smart Collection not found");ue.splice(a,1)},getTemplates:async()=>(await new Promise(t=>setTimeout(t,100)),zs),getAnalytics:async t=>{await new Promise(s=>setTimeout(s,150));const a=Fs.find(s=>s.collection_id===t);if(!a)throw new Error("Analytics not found");return a},testRules:async t=>(await new Promise(a=>setTimeout(a,100)),{valid:!0,sample_count:Math.floor(Math.random()*1e3)+10})};class Ls{constructor(){Ie(this,"baseUrl","/api/collections")}async tryApiCall(a,s){return s()}async getCollections(){return this.tryApiCall(async()=>(await Y.get(`${this.baseUrl}`)).data,()=>X.getSmartCollections())}async getCollection(a){return this.tryApiCall(async()=>(await Y.get(`${this.baseUrl}/${a}`)).data,()=>X.getSmartCollection(a))}async createCollection(a){return this.tryApiCall(async()=>(await Y.post(`${this.baseUrl}`,a)).data,()=>X.createSmartCollection({name:a.name,description:a.description,rules:a.smart_rules||[]}))}async updateCollection(a,s){return this.tryApiCall(async()=>(await Y.put(`${this.baseUrl}/${a}`,s)).data,()=>X.updateSmartCollection(a,s))}async deleteCollection(a){return this.tryApiCall(async()=>{await Y.delete(`${this.baseUrl}/${a}`)},()=>X.deleteSmartCollection(a))}async getCollectionItems(a,s=1,l=50){return this.tryApiCall(async()=>(await Y.get(`${this.baseUrl}/${a}/items`,{params:{page:s,limit:l}})).data,async()=>{const o=Array.from({length:20},(w,p)=>({id:`item${p+1}`,title:`Sample Item ${p+1}`,artist:`Sample Artist ${p+1}`,album:`Sample Album ${p+1}`,duration:Math.floor(Math.random()*300)+120,media_type:["music","video","image"][Math.floor(Math.random()*3)],file_size:Math.floor(Math.random()*1e7)+1e6,date_added:new Date(Date.now()-Math.random()*30*24*60*60*1e3).toISOString()}));return{items:o,total:o.length,page:s,limit:l}})}async refreshCollection(a){return this.tryApiCall(async()=>(await Y.post(`${this.baseUrl}/${a}/refresh`)).data,async()=>{await new Promise(l=>setTimeout(l,1e3));const s=await X.getSmartCollection(a);return s.item_count=Math.floor(Math.random()*100)+10,s.last_updated=new Date().toISOString(),s})}async getCollectionAnalytics(a){return this.tryApiCall(async()=>(await Y.get(`${this.baseUrl}/${a}/analytics`)).data,()=>X.getAnalytics(a))}async shareCollection(a,s){return this.tryApiCall(async()=>(await Y.post(`${this.baseUrl}/${a}/share`,s)).data,async()=>({share_id:`share_${a}_${Date.now()}`,share_url:`http://localhost:3006/shared/share_${a}_${Date.now()}`,expires_at:s.expires_at||new Date(Date.now()+2592e6).toISOString(),created_at:new Date().toISOString(),access_count:0,permissions:s}))}async getSharedCollection(a){return this.tryApiCall(async()=>(await Y.get(`${this.baseUrl}/shared/${a}`)).data,async()=>X.getSmartCollection("3"))}async exportCollection(a,s="json"){return this.tryApiCall(async()=>(await Y.get(`${this.baseUrl}/${a}/export`,{params:{format:s},responseType:"blob"})).data,async()=>{const l=await X.getSmartCollection(a);let o;return s==="json"?o=JSON.stringify(l,null,2):o=`name,description
${l.name},"${l.description||""}"`,new Blob([o],{type:s==="json"?"application/json":"text/csv"})})}async importCollection(a){return this.tryApiCall(async()=>{const s=new FormData;return s.append("file",a),(await Y.post(`${this.baseUrl}/import`,s,{headers:{"Content-Type":"multipart/form-data"}})).data},async()=>{const s=await a.text(),l=JSON.parse(s);return X.createSmartCollection({name:l.name,description:l.description,rules:l.smart_rules||[]})})}async duplicateCollection(a,s){return this.tryApiCall(async()=>(await Y.post(`${this.baseUrl}/${a}/duplicate`,{name:s})).data,async()=>{const l=await X.getSmartCollection(a);return X.createSmartCollection({name:s||`${l.name} (Copy)`,description:l.description,rules:l.smart_rules})})}async addItemsToCollection(a,s){return this.tryApiCall(async()=>{await Y.post(`${this.baseUrl}/${a}/items`,{item_ids:s})},async()=>{await new Promise(l=>setTimeout(l,200))})}async removeItemsFromCollection(a,s){return this.tryApiCall(async()=>{await Y.delete(`${this.baseUrl}/${a}/items`,{data:{item_ids:s}})},async()=>{await new Promise(l=>setTimeout(l,200))})}async getCollectionSuggestions(){return this.tryApiCall(async()=>(await Y.get(`${this.baseUrl}/suggestions`)).data,async()=>["Summer Mix 2024","Workout Music","Evening Jazz","Movie Night Favorites","Travel Photography"])}async getTemplates(){return this.tryApiCall(async()=>(await Y.get(`${this.baseUrl}/templates`)).data,()=>X.getTemplates())}async testRules(a){return this.tryApiCall(async()=>(await Y.post(`${this.baseUrl}/test-rules`,{rules:a})).data,()=>X.testRules(a))}async bulkDeleteCollections(a){return this.tryApiCall(async()=>{await Y.delete(`${this.baseUrl}/bulk`,{data:{collection_ids:a}})},async()=>{for(const s of a)await X.deleteSmartCollection(s)})}async bulkShareCollections(a,s){return this.tryApiCall(async()=>(await Y.post(`${this.baseUrl}/bulk/share`,{collection_ids:a,share_request:s})).data,async()=>{const l=[];for(const o of a){const w={share_id:`share_${o}_${Date.now()}`,share_url:`http://localhost:3006/shared/share_${o}_${Date.now()}`,expires_at:s.expires_at||new Date(Date.now()+2592e6).toISOString(),created_at:new Date().toISOString(),access_count:0,permissions:s};l.push(w)}return l})}async bulkExportCollections(a,s="json"){return this.tryApiCall(async()=>(await Y.post(`${this.baseUrl}/bulk/export`,{collection_ids:a,format:s},{responseType:"blob"})).data,async()=>{let l;const o=[];for(const w of a){const p=await X.getSmartCollection(w);o.push(p)}return s==="json"?l=JSON.stringify(o,null,2):l=`name,description
`+o.map(w=>`${w.name},"${w.description||""}"`).join(`
`),new Blob([l],{type:s==="json"?"application/json":"text/csv"})})}async bulkUpdateCollections(a,s,l){return this.tryApiCall(async()=>(await Y.put(`${this.baseUrl}/bulk`,{collection_ids:a,action:s,updates:l})).data,async()=>{const o=[];for(const w of a)if(s==="duplicate"){const p=await X.getSmartCollection(w),N=await X.createSmartCollection({name:`${p.name} (Copy)`,description:p.description,rules:p.smart_rules});o.push(N)}else if(l){const p=await X.updateSmartCollection(w,l);o.push(p)}return o})}}const ae=new Ls,qs=()=>{const t=Dt(),{data:a=[],isLoading:s,error:l,refetch:o}=Ke({queryKey:["collections"],queryFn:()=>ae.getCollections(),staleTime:300*1e3}),w=re({mutationFn:({collection:c})=>ae.createCollection(c),onSuccess:c=>{t.invalidateQueries({queryKey:["collections"]}),j.success(`Created collection: ${c.name}`)},onError:c=>{j.error(c.message||"Failed to create collection")}}),p=re({mutationFn:({id:c,updates:C})=>ae.updateCollection(c,C),onSuccess:c=>{t.invalidateQueries({queryKey:["collections"]}),t.invalidateQueries({queryKey:["collection",c.id]}),j.success(`Updated collection: ${c.name}`)},onError:c=>{j.error(c.message||"Failed to update collection")}}),N=re({mutationFn:({id:c})=>ae.deleteCollection(c),onSuccess:(c,{id:C})=>{t.invalidateQueries({queryKey:["collections"]}),t.removeQueries({queryKey:["collection",C]}),j.success("Collection deleted successfully")},onError:c=>{j.error(c.message||"Failed to delete collection")}}),_=re({mutationFn:({id:c})=>ae.refreshCollection(c),onSuccess:c=>{t.invalidateQueries({queryKey:["collections"]}),t.invalidateQueries({queryKey:["collection",c.id]}),j.success("Collection refreshed successfully")},onError:c=>{j.error(c.message||"Failed to refresh collection")}}),A=re({mutationFn:({id:c,shareRequest:C})=>ae.shareCollection(c,C),onSuccess:async c=>{try{await navigator.clipboard.writeText(c.share_url),j.success("Share link copied to clipboard!")}catch(C){j.success("Collection shared successfully!"),console.error("Failed to copy to clipboard:",C)}},onError:c=>{j.error(c.message||"Failed to share collection")}}),k=re({mutationFn:({id:c,newName:C})=>ae.duplicateCollection(c,C),onSuccess:c=>{t.invalidateQueries({queryKey:["collections"]}),j.success(`Duplicated collection: ${c.name}`)},onError:c=>{j.error(c.message||"Failed to duplicate collection")}}),L=re({mutationFn:({id:c,format:C})=>ae.exportCollection(c,C),onSuccess:(c,{id:C,format:y})=>{const $=window.URL.createObjectURL(c),H=document.createElement("a");H.href=$,H.download=`collection-${C}.${y}`,document.body.appendChild(H),H.click(),window.URL.revokeObjectURL($),document.body.removeChild(H),j.success("Collection exported successfully")},onError:c=>{j.error(c.message||"Failed to export collection")}}),b=re({mutationFn:({collectionIds:c})=>ae.bulkDeleteCollections(c),onSuccess:(c,{collectionIds:C})=>{t.invalidateQueries({queryKey:["collections"]}),C.forEach(y=>{t.removeQueries({queryKey:["collection",y]})})},onError:c=>{j.error(c.message||"Failed to delete collections")}}),D=re({mutationFn:({collectionIds:c,shareRequest:C})=>ae.bulkShareCollections(c,C),onSuccess:()=>{t.invalidateQueries({queryKey:["collections"]})},onError:c=>{j.error(c.message||"Failed to share collections")}}),S=re({mutationFn:({collectionIds:c,format:C})=>ae.bulkExportCollections(c,C),onSuccess:(c,{format:C})=>{const y=window.URL.createObjectURL(c),$=document.createElement("a");$.href=y,$.download=`collections-bulk-export.${C}`,document.body.appendChild($),$.click(),window.URL.revokeObjectURL(y),document.body.removeChild($),j.success("Collections exported successfully")},onError:c=>{j.error(c.message||"Failed to export collections")}}),r=re({mutationFn:({collectionIds:c,action:C,updates:y})=>ae.bulkUpdateCollections(c,C,y),onSuccess:()=>{t.invalidateQueries({queryKey:["collections"]})},onError:c=>{j.error(c.message||"Failed to update collections")}});return{collections:a,isLoading:s,error:l,refetchCollections:o,createCollection:w.mutateAsync,updateCollection:p.mutateAsync,deleteCollection:N.mutateAsync,refreshCollection:_.mutateAsync,shareCollection:A.mutateAsync,duplicateCollection:k.mutateAsync,exportCollection:L.mutateAsync,bulkDeleteCollections:b.mutateAsync,bulkShareCollections:D.mutateAsync,bulkExportCollections:S.mutateAsync,bulkUpdateCollections:r.mutateAsync,isCreating:w.isPending,isUpdating:p.isPending,isDeleting:N.isPending,isRefreshing:_.isPending,isSharing:A.isPending,isDuplicating:k.isPending,isExporting:L.isPending,isBulkDeleting:b.isPending,isBulkSharing:D.isPending,isBulkExporting:S.isPending,isBulkUpdating:r.isPending}},qe=t=>{Dt();const{data:a,isLoading:s,error:l,refetch:o}=Ke({queryKey:["collection",t],queryFn:()=>ae.getCollection(t),enabled:!!t,staleTime:300*1e3}),{data:w,isLoading:p,refetch:N}=Ke({queryKey:["collection-items",t],queryFn:()=>ae.getCollectionItems(t),enabled:!!t,staleTime:120*1e3});return{collection:a,collectionItems:w,isLoading:s,isLoadingItems:p,error:l,refetchCollection:o,refetchItems:N}},Us={music:Le,video:at,image:Ot,document:ve},Bs=t=>{if(!t)return"--:--";const a=Math.floor(t/60),s=Math.floor(t%60);return`${a}:${s.toString().padStart(2,"0")}`},Vs=t=>{const a=["B","KB","MB","GB"];let s=t,l=0;for(;s>=1024&&l<a.length-1;)s/=1024,l++;return`${s.toFixed(1)} ${a[l]}`},Qs=t=>t?e.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(a=>e.jsx(je,{className:`w-3 h-3 ${a<=t?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},a))}):null,Hs=({collection:t,isLoading:a=!1,onClose:s,onPlayItem:l,onPreviewItem:o,onViewAllItems:w})=>{const[p,N]=n.useState(null),[_,A]=n.useState(new Set),{collectionItems:k,isLoadingItems:L}=qe(t.id),b=(y,$)=>{$.stopPropagation();const H=new Set(_);H.has(y)?H.delete(y):H.add(y),A(H)},D=(y,$)=>{$.stopPropagation(),l==null||l(y),j.success("Playing item")},S=(y,$)=>{o==null||o(y),j.success("Previewing item")},r=y=>{j.success(`Downloading ${y.title}`)};if(a||L)return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx(M.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-4xl max-h-[80vh] overflow-hidden",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"space-y-3",children:[1,2,3,4,5].map(y=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]},y))})]})})})});const c=(k==null?void 0:k.items)||[],C=(k==null?void 0:k.total)||0;return e.jsx(ie,{children:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(M.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-4xl max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[C," items total"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[_.size>0&&e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[_.size," selected"]}),e.jsx(v,{variant:"ghost",size:"sm",onClick:s,children:e.jsx(de,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(80vh-120px)]",children:[e.jsx("div",{className:"space-y-2",children:e.jsx(ie,{children:c.map((y,$)=>{const H=Us[y.media_type],O=p===y.id,z=_.has(y.id);return e.jsxs(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2,delay:$*.05},className:`
                        group relative flex items-center gap-3 p-3 rounded-lg cursor-pointer
                        ${z?"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700":"hover:bg-gray-50 dark:hover:bg-gray-800"}
                      `,onMouseEnter:()=>N(y.id),onMouseLeave:()=>N(null),onClick:()=>S(y.id),children:[e.jsx("div",{className:"absolute left-2 top-1/2 -translate-y-1/2",onClick:V=>b(y.id,V),children:e.jsx("div",{className:`
                          w-4 h-4 rounded border-2 transition-colors
                          ${z?"bg-blue-500 border-blue-500":"border-gray-300 dark:border-gray-600"}
                        `,children:z&&e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("div",{className:"w-2 h-2 bg-white rounded-sm"})})})}),e.jsxs("div",{className:"relative ml-6",children:[y.thumbnail_url?e.jsx("img",{src:y.thumbnail_url,alt:y.title,className:"w-12 h-12 rounded object-cover"}):e.jsx("div",{className:"w-12 h-12 bg-gray-100 dark:bg-gray-800 rounded flex items-center justify-center",children:e.jsx(H,{className:"w-6 h-6 text-gray-400"})}),O&&e.jsx(M.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 bg-black/40 rounded flex items-center justify-center",onClick:V=>D(y.id,V),children:y.is_playing?e.jsx(qa,{className:"w-4 h-4 text-white"}):e.jsx(Me,{className:"w-4 h-4 text-white"})}),y.is_favorite&&e.jsx("div",{className:"absolute -top-1 -right-1",children:e.jsx(je,{className:"w-3 h-3 fill-yellow-400 text-yellow-400"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white truncate",children:y.title}),y.rating&&Qs(y.rating)]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[y.artist&&e.jsx("span",{className:"truncate",children:y.artist}),y.album&&e.jsx("span",{className:"truncate",children:y.album}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ae,{className:"w-3 h-3"}),Bs(y.duration)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ua,{className:"w-3 h-3"}),Vs(y.file_size)]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{className:"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",title:"Download",onClick:V=>{V.stopPropagation(),r(y)},children:e.jsx(oe,{className:"w-4 h-4 text-gray-500"})}),e.jsx("button",{className:"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",title:"More options",onClick:V=>V.stopPropagation(),children:e.jsx($t,{className:"w-4 h-4 text-gray-500"})})]})]},y.id)})})}),c.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ke,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No items found"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"This collection doesn't have any items yet."})]}),c.length<C&&c.length>0&&e.jsx("div",{className:"text-center py-4",children:e.jsx(v,{variant:"ghost",onClick:w,children:"View All Items"})})]})]})})})},tt=({selectedCollections:t,collections:a,onOperation:s,onClose:l})=>{var H;const[o,w]=n.useState(!1),[p,N]=n.useState(null),[_,A]=n.useState({}),[k,L]=n.useState(!1),[b,D]=n.useState(!1),S=[{id:"delete",label:"Delete Collections",icon:be,description:"Permanently remove selected collections",requiresConfirmation:!0},{id:"share",label:"Share Collections",icon:pe,description:"Share selected collections with others",requiresConfirmation:!1,options:wt},{id:"export",label:"Export Collections",icon:oe,description:"Export selected collections to file",requiresConfirmation:!1,options:Nt},{id:"duplicate",label:"Duplicate Collections",icon:Te,description:"Create copies of selected collections",requiresConfirmation:!1,options:kt},{id:"tag",label:"Add Tags",icon:Ba,description:"Add tags to selected collections",requiresConfirmation:!1,options:Ct},{id:"archive",label:"Archive Collections",icon:zt,description:"Archive selected collections to storage",requiresConfirmation:!1,options:_t},{id:"move",label:"Move Collections",icon:Va,description:"Move selected collections to folder",requiresConfirmation:!1,options:St}],r=O=>{const z=S.find(V=>V.id===O);z&&(z.requiresConfirmation?(N(O),L(!0)):z.options?(N(O),A({})):c(O))},c=async(O,z)=>{try{D(!0),s(O,z||_),w(!1),N(null),A({}),L(!1),l()}catch(V){console.error("Bulk action failed:",V)}finally{D(!1)}},C=async()=>{p&&await c(p,_)},y=O=>{const z=S.find(V=>V.id===O);return z?z.icon:$t},$=O=>{const z=S.find(V=>V.id===O);return z?z.description:""};return e.jsx(ie,{children:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(M.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-4xl max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Bulk Operations"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[t.length," collections selected"]})]}),e.jsx(v,{variant:"ghost",size:"sm",onClick:l,disabled:b,children:e.jsx(de,{className:"w-4 h-4"})})]}),p?e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(80vh-120px)]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center",children:fe.createElement(y(p),{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:(H=S.find(O=>O.id===p))==null?void 0:H.label}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:$(p)})]})]}),e.jsxs("div",{className:"mb-6",children:[p==="share"&&e.jsx(wt,{value:_,onChange:A}),p==="export"&&e.jsx(Nt,{value:_,onChange:A}),p==="duplicate"&&e.jsx(kt,{value:_,onChange:A}),p==="tag"&&e.jsx(Ct,{value:_,onChange:A}),p==="archive"&&e.jsx(_t,{value:_,onChange:A}),p==="move"&&e.jsx(St,{value:_,onChange:A}),p==="delete"&&e.jsx(Ks,{value:_,onChange:A})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{variant:"outline",onClick:()=>{N(null),A({})},disabled:b,children:"Back"}),e.jsx(v,{onClick:()=>{var O;(O=S.find(z=>z.id===p))!=null&&O.requiresConfirmation?L(!0):c(p)},disabled:b,className:"flex-1",children:b?"Processing...":"Execute Action"})]})]}):e.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(80vh-120px)]",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:S.map(O=>{const z=O.icon;return e.jsx(M.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"p-4 rounded-lg border cursor-pointer transition-all border-gray-200 dark:border-gray-700 hover:border-blue-500 dark:hover:border-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20",onClick:()=>r(O.id),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center",children:e.jsx(z,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:O.label}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:O.description})]})]})},O.id)})})}),k&&e.jsx("div",{className:"absolute inset-0 bg-black/70 flex items-center justify-center",children:e.jsxs(M.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center",children:e.jsx(be,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Collections?"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["This will permanently delete ",t.length," collection(s) and cannot be undone."]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{variant:"outline",onClick:()=>{L(!1),N(null),A({})},disabled:b,children:"Cancel"}),e.jsx(v,{variant:"destructive",onClick:C,disabled:b,children:b?"Deleting...":"Delete"})]})]})})]})})})},wt=({value:t,onChange:a})=>{var s,l;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Download Permission"}),e.jsx(G,{checked:((s=t.shareWithPermissions)==null?void 0:s.can_download)??!0,onCheckedChange:o=>a({...t,shareWithPermissions:{...t.shareWithPermissions,can_download:o}})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Reshare Permission"}),e.jsx(G,{checked:((l=t.shareWithPermissions)==null?void 0:l.can_reshare)??!1,onCheckedChange:o=>a({...t,shareWithPermissions:{...t.shareWithPermissions,can_reshare:o}})})]})]})},Nt=({value:t,onChange:a})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Export Format"}),e.jsxs("select",{value:t.exportFormat||"json",onChange:s=>a({...t,exportFormat:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"json",children:"JSON"}),e.jsx("option",{value:"csv",children:"CSV"}),e.jsx("option",{value:"m3u",children:"M3U Playlist"})]})]}),kt=({value:t,onChange:a})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Suffix"}),e.jsx("input",{type:"text",value:t.suffix||"(Copy)",onChange:s=>a({...t,suffix:s.target.value}),placeholder:"Add suffix to duplicated collections",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),Ct=({value:t,onChange:a})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Tags"}),e.jsx("input",{type:"text",value:(t.addTags||[]).join(", "),onChange:s=>a({...t,addTags:s.target.value.split(",").map(l=>l.trim()).filter(Boolean)}),placeholder:"Enter tags separated by commas",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),_t=({value:t,onChange:a})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Archive Location"}),e.jsxs("select",{value:t.archiveLocation||"default",onChange:s=>a({...t,archiveLocation:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"default",children:"Default Archive"}),e.jsx("option",{value:"custom",children:"Custom Location"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Compress Archive"}),e.jsx(G,{checked:t.compressArchive??!0,onCheckedChange:s=>a({...t,compressArchive:s})})]})]}),St=({value:t,onChange:a})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Destination Folder"}),e.jsx("input",{type:"text",value:t.moveTo||"",onChange:s=>a({...t,moveTo:s.target.value}),placeholder:"Enter destination folder path",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),Ks=({value:t,onChange:a})=>e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.deleteForever??!1,onChange:s=>a({...t,deleteForever:s.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Delete permanently (cannot be recovered)"})]})}),Qt=Object.freeze(Object.defineProperty({__proto__:null,BulkOperations:tt,default:tt},Symbol.toStringTag,{value:"Module"})),Gs=({children:t,itemCount:a,threshold:s=100,loadingStrategy:l="lazy",itemHeight:o=60,containerHeight:w=400,onVisibleItemsChange:p})=>{const N=n.useRef(null),[_,A]=n.useState([0,Math.min(20,a)]),[k,L]=n.useState(0),[b,D]=n.useState(new Map),[S,r]=n.useState(new Set),c=n.useRef(null),C=n.useCallback(F=>{const E=Math.floor(F/o),x=Math.min(E+Math.ceil(w/o)+5,a-1);return[Math.max(0,E),x]},[o,w,a]),y=n.useCallback(()=>{if(!N.current)return;const F=N.current.scrollTop;if(L(F),l==="virtual"){const E=C(F);A(E),p==null||p(E)}},[l,C,p]);n.useEffect(()=>{if(l==="lazy")return c.current=new IntersectionObserver(F=>{F.forEach(E=>{const x=parseInt(E.target.getAttribute("data-index")||"0");D(f=>new Map(f.set(x,E.isIntersecting))),E.isIntersecting&&!S.has(x)&&r(f=>new Set(f).add(x))})},{root:N.current,rootMargin:"50px",threshold:.1}),()=>{var F;(F=c.current)==null||F.disconnect()}},[l,S]),n.useEffect(()=>{const F=N.current;if(!F)return;let E;const x=()=>{clearTimeout(E),E=setTimeout(y,16)};return F.addEventListener("scroll",x),()=>{F.removeEventListener("scroll",x),clearTimeout(E)}},[y]);const $=()=>{if(!Array.isArray(t))return t;const[F,E]=_,x=[],f=a*o;for(let P=F;P<=E;P++){const q=t[P];if(!q)continue;const Q=P*o;x.push(e.jsx(M.div,{style:{position:"absolute",top:`${Q}px`,left:0,right:0,height:`${o}px`},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.2,delay:(P-F)*.02},children:fe.cloneElement(q,{index:P})},P))}return e.jsx("div",{style:{height:`${f}px`,position:"relative"},children:x})},H=()=>Array.isArray(t)?t.map((F,E)=>{const x=S.has(E)||E<10;return e.jsx(M.div,{"data-index":E,initial:{opacity:0,y:20},animate:{opacity:x?1:0,y:x?0:20},transition:{duration:.3,delay:x?0:E*.05},style:{minHeight:x?"auto":`${o}px`},children:x?F:e.jsx("div",{className:"animate-pulse bg-gray-100 dark:bg-gray-800 rounded",style:{height:`${o}px`}})},E)}):t,O=()=>{if(!Array.isArray(t))return t;const[F,E]=_;return t.slice(F,E+1).map((x,f)=>e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.2,delay:f*.05},children:x},F+f))},z=a>s,V=()=>{if(!z)return t;switch(l){case"virtual":return $();case"lazy":return H();case"pagination":return O();default:return t}};return z?e.jsxs("div",{ref:N,className:"overflow-auto",style:{height:`${w}px`},onScroll:y,children:[V(),l==="pagination"&&_[1]<a-1&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full"})})]}):e.jsx(e.Fragment,{children:t})},It={defaultView:"grid",itemsPerPage:20,thumbnailSize:"medium",showThumbnails:!0,showMetadata:!0,compactView:!1,autoRefresh:!1,refreshInterval:30,sortOrder:"date_added",sortDirection:"desc",autoPlayNext:!0,loopPlayback:!1,rememberPosition:!0,shuffleByDefault:!1,defaultDownloadFormat:"original",downloadQuality:"original",downloadLocation:"default",defaultSharePermissions:{can_download:!0,can_reshare:!1,expires_after_days:7},shareAnalytics:!0,notifyOnNewItems:!1,notifyOnCollectionChanges:!0,notifyOnSharedAccess:!0,isPrivate:!1,requirePassword:!1},Ws=[{value:"small",label:"Small (128px)"},{value:"medium",label:"Medium (256px)"},{value:"large",label:"Large (512px)"}],Js=[10,20,50,100],Zs=[5,10,15,30,60,120],Ys=[{value:"original",label:"Original Quality"},{value:"high",label:"High Quality"},{value:"medium",label:"Medium Quality"},{value:"low",label:"Low Quality"}],Xs=[{value:"name",label:"Name"},{value:"date_added",label:"Date Added"},{value:"date_modified",label:"Date Modified"},{value:"size",label:"File Size"},{value:"rating",label:"Rating"}],el=[{value:"",label:"No Grouping"},{value:"artist",label:"Artist"},{value:"album",label:"Album"},{value:"genre",label:"Genre"},{value:"year",label:"Year"},{value:"type",label:"Media Type"}],tl=({collection:t,onClose:a,onSave:s})=>{const[l,o]=n.useState(It),[w,p]=n.useState(!1),[N,_]=n.useState("display"),[A,k]=n.useState(!1);n.useEffect(()=>{if(!t)return;const r=localStorage.getItem(`collection_prefs_${t.id}`);if(r)try{const c=JSON.parse(r);o({...It,...c})}catch(c){console.error("Failed to load preferences:",c)}},[t]);const L=async()=>{if(t){p(!0);try{localStorage.setItem(`collection_prefs_${t.id}`,JSON.stringify(l)),await s({is_public:!l.isPrivate}),k(!1)}catch(r){console.error("Failed to save preferences:",r)}finally{p(!1)}}},b=(r,c)=>{o(C=>({...C,[r]:c})),k(!0)},D=(r,c)=>{o(C=>{const[y,$]=r.split(".");return{...C,[y]:{...C[y],[$]:c}}}),k(!0)},S=[{id:"display",label:"Display",icon:Qa},{id:"behavior",label:"Behavior",icon:$e},{id:"playback",label:"Playback",icon:Me},{id:"download",label:"Download",icon:oe},{id:"sharing",label:"Sharing",icon:pe},{id:"privacy",label:"Privacy",icon:Ha}];return e.jsx(M.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs(M.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Collection Settings"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:t.name})]}),e.jsx(v,{variant:"ghost",size:"sm",onClick:a,children:e.jsx(de,{className:"w-5 h-5"})})]})}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsx("div",{className:"w-48 border-r border-gray-200 dark:border-gray-700 p-4",children:e.jsx("nav",{className:"space-y-1",children:S.map(r=>{const c=r.icon,C=N===r.id;return e.jsxs("button",{onClick:()=>_(r.id),className:`
                      w-full flex items-center gap-3 px-3 py-2 rounded-lg text-left transition-colors
                      ${C?"bg-blue-50 text-blue-600 dark:bg-blue-900/20 dark:text-blue-400":"text-gray-600 hover:bg-gray-50 dark:text-gray-400 dark:hover:bg-gray-800"}
                    `,children:[e.jsx(c,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:r.label})]},r.id)})})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[N==="display"&&e.jsxs(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"View Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Default View"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>b("defaultView","grid"),className:`
                            flex items-center gap-2 px-4 py-2 rounded-lg border
                            ${l.defaultView==="grid"?"bg-blue-50 border-blue-200 text-blue-700 dark:bg-blue-900/20 dark:border-blue-700 dark:text-blue-300":"border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-300"}
                          `,children:[e.jsx(ze,{className:"w-4 h-4"}),"Grid"]}),e.jsxs("button",{onClick:()=>b("defaultView","list"),className:`
                            flex items-center gap-2 px-4 py-2 rounded-lg border
                            ${l.defaultView==="list"?"bg-blue-50 border-blue-200 text-blue-700 dark:bg-blue-900/20 dark:border-blue-700 dark:text-blue-300":"border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-300"}
                          `,children:[e.jsx(Ft,{className:"w-4 h-4"}),"List"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Items Per Page"}),e.jsx(Z,{value:l.itemsPerPage.toString(),onChange:r=>b("itemsPerPage",parseInt(r)),options:Js.map(r=>({value:r.toString(),label:`${r} items`}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Thumbnail Size"}),e.jsx(Z,{value:l.thumbnailSize,onChange:r=>b("thumbnailSize",r),options:Ws})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Display Options"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Show Thumbnails"}),e.jsx(G,{checked:l.showThumbnails,onCheckedChange:r=>b("showThumbnails",r)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Show Metadata"}),e.jsx(G,{checked:l.showMetadata,onCheckedChange:r=>b("showMetadata",r)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Compact View"}),e.jsx(G,{checked:l.compactView,onCheckedChange:r=>b("compactView",r)})]})]})]})]}),N==="behavior"&&e.jsxs(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Auto-Refresh"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Auto Refresh Collection"}),e.jsx(G,{checked:l.autoRefresh,onCheckedChange:r=>b("autoRefresh",r)})]}),l.autoRefresh&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Refresh Interval"}),e.jsx(Z,{value:l.refreshInterval.toString(),onChange:r=>b("refreshInterval",parseInt(r)),options:Zs.map(r=>({value:r.toString(),label:r>=60?`${r/60} hours`:`${r} minutes`}))})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Sort & Group"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sort By"}),e.jsx(Z,{value:l.sortOrder,onChange:r=>b("sortOrder",r),options:Xs})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sort Direction"}),e.jsx(Z,{value:l.sortDirection,onChange:r=>b("sortDirection",r),options:[{value:"asc",label:"Ascending"},{value:"desc",label:"Descending"}]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Group By"}),e.jsx(Z,{value:l.groupBy||"",onChange:r=>b("groupBy",r),options:el})]})]})]})]}),N==="playback"&&e.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Auto Play Next Item"}),e.jsx(G,{checked:l.autoPlayNext,onCheckedChange:r=>b("autoPlayNext",r)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Loop Playback"}),e.jsx(G,{checked:l.loopPlayback,onCheckedChange:r=>b("loopPlayback",r)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Remember Playback Position"}),e.jsx(G,{checked:l.rememberPosition,onCheckedChange:r=>b("rememberPosition",r)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Shuffle by Default"}),e.jsx(G,{checked:l.shuffleByDefault,onCheckedChange:r=>b("shuffleByDefault",r)})]})]})}),N==="download"&&e.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Download Options"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Default Format"}),e.jsx(Z,{value:l.defaultDownloadFormat,onChange:r=>b("defaultDownloadFormat",r),options:[{value:"original",label:"Original Format"},{value:"mp3",label:"MP3"},{value:"mp4",label:"MP4"},{value:"flac",label:"FLAC"}]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Download Quality"}),e.jsx(Z,{value:l.downloadQuality,onChange:r=>b("downloadQuality",r),options:Ys})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Download Location"}),e.jsx(Z,{value:l.downloadLocation,onChange:r=>b("downloadLocation",r),options:[{value:"default",label:"Default Downloads Folder"},{value:"custom",label:"Custom Location"}]})]}),l.downloadLocation==="custom"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Custom Path"}),e.jsx("input",{type:"text",value:l.customDownloadPath||"",onChange:r=>b("customDownloadPath",r.target.value),placeholder:"/path/to/downloads",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]})]})}),N==="sharing"&&e.jsxs(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Default Permissions"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Allow Download"}),e.jsx(G,{checked:l.defaultSharePermissions.can_download,onCheckedChange:r=>D("defaultSharePermissions.can_download",r)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Allow Reshare"}),e.jsx(G,{checked:l.defaultSharePermissions.can_reshare,onCheckedChange:r=>D("defaultSharePermissions.can_reshare",r)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Default Expiry (Days)"}),e.jsx("input",{type:"number",min:"1",max:"365",value:l.defaultSharePermissions.expires_after_days,onChange:r=>D("defaultSharePermissions.expires_after_days",parseInt(r.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Analytics"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Track Share Analytics"}),e.jsx(G,{checked:l.shareAnalytics,onCheckedChange:r=>b("shareAnalytics",r)})]})]})]}),N==="privacy"&&e.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Privacy Controls"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Private Collection"}),e.jsx(G,{checked:l.isPrivate,onCheckedChange:r=>b("isPrivate",r)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Require Password"}),e.jsx(G,{checked:l.requirePassword,onCheckedChange:r=>b("requirePassword",r)})]}),l.requirePassword&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Collection Password"}),e.jsx("input",{type:"password",value:l.password||"",onChange:r=>b("password",r.target.value),placeholder:"Enter collection password",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]})]})})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:A?"You have unsaved changes":"All changes saved"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{variant:"outline",onClick:a,children:"Cancel"}),e.jsxs(v,{onClick:L,disabled:w||!A,children:[e.jsx(Rt,{className:"w-4 h-4 mr-2"}),w?"Saving...":"Save Settings"]})]})]})})]})})},At={music:Ga,video:Lt,image:Ka,document:ve},al=[{value:"7d",label:"Last 7 Days"},{value:"30d",label:"Last 30 Days"},{value:"90d",label:"Last 90 Days"},{value:"1y",label:"Last Year"},{value:"all",label:"All Time"}],sl=[{value:"plays",label:"Plays"},{value:"downloads",label:"Downloads"},{value:"shares",label:"Shares"},{value:"views",label:"Views"}],Ht=({collection:t,onClose:a})=>{const[s,l]=n.useState("30d"),[o,w]=n.useState("plays"),[p,N]=n.useState(!1),[_,A]=n.useState(!1),[k,L]=n.useState("overview"),{collectionItems:b,isLoading:D}=qe((t==null?void 0:t.id)||""),S=b||[],r=n.useMemo(()=>{const x=S.length,f=S.reduce((u,T)=>u+(T.size||0),0),P=S.reduce((u,T)=>u+(T.rating||0),0)/x||0,q=u=>{const T=new Date,d=[];let h=30;s==="7d"?h=u==="daily"?7:1:s==="30d"?h=u==="daily"?30:u==="weekly"?4:1:s==="90d"?h=u==="daily"?90:u==="weekly"?12:3:s==="1y"&&(h=u==="daily"?365:u==="weekly"?52:12);for(let I=h-1;I>=0;I--){const R=new Date(T);u==="daily"?(R.setDate(R.getDate()-I),d.push({date:R.toLocaleDateString(),plays:Math.floor(Math.random()*100)+20,downloads:Math.floor(Math.random()*20)+5,shares:Math.floor(Math.random()*10)+1})):u==="weekly"?(R.setDate(R.getDate()-I*7),d.push({week:`Week ${I+1}`,plays:Math.floor(Math.random()*500)+100,downloads:Math.floor(Math.random()*50)+10,shares:Math.floor(Math.random()*30)+5})):(R.setMonth(R.getMonth()-I),d.push({month:R.toLocaleDateString("en",{month:"short",year:"numeric"}),plays:Math.floor(Math.random()*2e3)+500,downloads:Math.floor(Math.random()*200)+50,shares:Math.floor(Math.random()*100)+20}))}return d},Q=S.reduce((u,T)=>{const d=T.media_type||"document";return u[d]=(u[d]||0)+1,u},{}),i=S.filter(u=>u.rating||Math.random()>.5).slice(0,10).map(u=>({id:u.id,title:u.title||u.name||"Unknown",type:u.media_type||"document",plays:Math.floor(Math.random()*1e3)+100,rating:u.rating||Math.random()*5,size:c(u.size||Math.random()*1e9)})).sort((u,T)=>T.plays-u.plays);return{overview:{totalItems:x,totalSize:c(f),totalDuration:C(S.reduce((u,T)=>u+(T.duration||0),0)),averageRating:P,playCount:Math.floor(Math.random()*1e4)+1e3,downloadCount:Math.floor(Math.random()*1e3)+100,shareCount:Math.floor(Math.random()*500)+50,viewCount:Math.floor(Math.random()*2e4)+2e3},mediaBreakdown:{music:Q.music||0,video:Q.video||0,image:Q.image||0,document:Q.document||0},activity:{daily:q("daily"),weekly:q("weekly"),monthly:q("monthly")},topItems:i,sharingStats:{sharedByType:{link:Math.floor(Math.random()*100)+20,email:Math.floor(Math.random()*50)+10,social:Math.floor(Math.random()*30)+5,embed:Math.floor(Math.random()*20)+5},sharePerformance:Array.from({length:30},(u,T)=>({date:new Date(Date.now()-(29-T)*24*60*60*1e3).toLocaleDateString(),shares:Math.floor(Math.random()*20)+5,clicks:Math.floor(Math.random()*100)+20,downloads:Math.floor(Math.random()*50)+10})),topReferrers:[{source:"Direct",visits:1e3,conversion:15.5},{source:"Google",visits:500,conversion:8.2},{source:"Facebook",visits:300,conversion:12.1},{source:"Twitter",visits:200,conversion:9.8},{source:"Email",visits:150,conversion:22.3}]},engagementMetrics:{completionRate:Math.random()*50+50,averageWatchTime:C(Math.floor(Math.random()*3600)+300),skipRate:Math.random()*30,repeatViews:Math.floor(Math.random()*1e3)+200,comments:Math.floor(Math.random()*100)+20,likes:Math.floor(Math.random()*500)+100}}},[S,s]),c=x=>{if(x===0)return"0 B";const f=1024,P=["B","KB","MB","GB","TB"],q=Math.floor(Math.log(x)/Math.log(f));return parseFloat((x/Math.pow(f,q)).toFixed(2))+" "+P[q]},C=x=>{const f=Math.floor(x/3600),P=Math.floor(x%3600/60),q=Math.floor(x%60);return f>0?`${f}h ${P}m`:P>0?`${P}m ${q}s`:`${q}s`},y=x=>{const f={collection:t.name,generated:new Date().toISOString(),timeRange:s,analytics:r};if(x==="json"){const P=new Blob([JSON.stringify(f,null,2)],{type:"application/json"}),q=URL.createObjectURL(P),Q=document.createElement("a");Q.href=q,Q.download=`collection-analytics-${t.name}-${Date.now()}.json`,Q.click(),URL.revokeObjectURL(q)}else if(x==="csv"){const P=`Metric,Value
Total Items,${r.overview.totalItems}
Total Size,${r.overview.totalSize}
Average Rating,${r.overview.averageRating.toFixed(2)}
Play Count,${r.overview.playCount}
Download Count,${r.overview.downloadCount}
Share Count,${r.overview.shareCount}
View Count,${r.overview.viewCount}`,q=new Blob([P],{type:"text/csv"}),Q=URL.createObjectURL(q),i=document.createElement("a");i.href=Q,i.download=`collection-analytics-${t.name}-${Date.now()}.csv`,i.click(),URL.revokeObjectURL(Q)}},$=({title:x,value:f,icon:P,change:q,changeType:Q})=>e.jsx(M.div,{whileHover:{scale:1.02},className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:x}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:f}),q!==void 0&&e.jsxs("div",{className:"flex items-center mt-2 text-sm",children:[Q==="increase"?e.jsx(Ja,{className:"w-4 h-4 text-green-500 mr-1"}):e.jsx(yt,{className:"w-4 h-4 text-red-500 mr-1"}),e.jsxs("span",{className:Q==="increase"?"text-green-500":"text-red-500",children:[q,"%"]}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400 ml-1",children:"vs last period"})]})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg",children:e.jsx(P,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})})]})}),H=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx($,{title:"Total Items",value:r.overview.totalItems.toLocaleString(),icon:We,change:12.5,changeType:"increase"}),e.jsx($,{title:"Total Plays",value:r.overview.playCount.toLocaleString(),icon:Me,change:8.3,changeType:"increase"}),e.jsx($,{title:"Downloads",value:r.overview.downloadCount.toLocaleString(),icon:oe,change:-2.1,changeType:"decrease"}),e.jsx($,{title:"Shares",value:r.overview.shareCount.toLocaleString(),icon:pe,change:15.7,changeType:"increase"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(W,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Media Breakdown"}),e.jsx("div",{className:"space-y-3",children:Object.entries(r.mediaBreakdown).map(([x,f])=>{const P=At[x],q=Object.values(r.mediaBreakdown).reduce((i,u)=>i+u,0),Q=q>0?f/q*100:0;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 p-2 rounded",children:e.jsx(P,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white capitalize",children:x}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[f," items"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:[Q.toFixed(1),"%"]}),e.jsx("div",{className:"w-24 bg-gray-200 dark:bg-gray-700 rounded-full h-2 mt-1",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${Q}%`}})})]})]},x)})})]}),e.jsxs(W,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Collection Stats"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Total Size"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r.overview.totalSize})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Total Duration"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r.overview.totalDuration})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Average Rating"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"w-4 h-4 text-yellow-500 fill-current"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r.overview.averageRating.toFixed(1)})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Total Views"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r.overview.viewCount.toLocaleString()})]})]})]})]}),e.jsxs(W,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Top Items"}),e.jsx("div",{className:"space-y-3",children:r.topItems.slice(0,5).map((x,f)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center text-sm font-semibold text-blue-600 dark:text-blue-400",children:f+1}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate max-w-xs",children:x.title}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:[(()=>{const P=At[x.type]||ve;return e.jsx(P,{className:"w-3 h-3"})})(),e.jsx("span",{children:x.size})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:x.plays}),e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(je,{className:"w-3 h-3 text-yellow-500 fill-current"}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:x.rating.toFixed(1)})]})]})]},x.id))})]})]}),O=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Activity Trends"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Z,{value:s,onChange:l,options:al,className:"w-40"}),e.jsx(Z,{value:o,onChange:w,options:sl,className:"w-32"})]})]}),e.jsx(W,{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["daily","weekly","monthly"].map(x=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"font-medium text-gray-900 dark:text-white capitalize",children:[x," Activity"]}),e.jsx("div",{className:"space-y-2",children:r.activity[x].slice(0,5).map((f,P)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:x==="daily"?f.date:x==="weekly"?f.week:f.month}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:f[o]||0})]},P))})]},x))})})}),e.jsxs(W,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Engagement Metrics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:[r.engagementMetrics.completionRate.toFixed(1),"%"]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Completion Rate"})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:r.engagementMetrics.averageWatchTime}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Avg Watch Time"})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:r.engagementMetrics.repeatViews.toLocaleString()}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Repeat Views"})]})]})]})]}),z=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(W,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Share Types"}),e.jsx("div",{className:"space-y-3",children:Object.entries(r.sharingStats.sharedByType).map(([x,f])=>{const P=Object.values(r.sharingStats.sharedByType).reduce((u,T)=>u+T,0),q=P>0?f/P*100:0,i={link:Ut,email:st,social:Wa,embed:Ne}[x]||pe;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(i,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"}),e.jsx("span",{className:"capitalize text-gray-900 dark:text-white",children:x})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-20 bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${q}%`}})}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white w-12 text-right",children:f})]})]},x)})})]}),e.jsxs(W,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Top Referrers"}),e.jsx("div",{className:"space-y-3",children:r.sharingStats.topReferrers.map((x,f)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center text-xs font-semibold text-blue-600 dark:text-blue-400",children:f+1}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:x.source})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:x.visits}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[x.conversion,"% conv."]})]})]},x.source))})]})]}),e.jsxs(W,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Recent Share Activity"}),e.jsx("div",{className:"space-y-2",children:r.sharingStats.sharePerformance.slice(0,10).map((x,f)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("div",{children:e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:x.date})}),e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-3 h-3 text-gray-500"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:x.shares})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ke,{className:"w-3 h-3 text-gray-500"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:x.clicks})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(oe,{className:"w-3 h-3 text-gray-500"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:x.downloads})]})]})]},f))})]})]}),V=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs(W,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Content Performance"}),e.jsx("div",{className:"space-y-4",children:r.topItems.map((x,f)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center text-sm font-semibold text-blue-600 dark:text-blue-400",children:f+1}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white mb-1",children:x.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx("span",{className:"capitalize",children:x.type}),e.jsx("span",{children:x.size}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(je,{className:"w-3 h-3 text-yellow-500 fill-current"}),e.jsx("span",{children:x.rating.toFixed(1)})]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-white",children:x.plays}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"plays"})]})]},x.id))})]})}),F=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs(W,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Completion Rate"}),e.jsx(Fe,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:[r.engagementMetrics.completionRate.toFixed(1),"%"]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3",children:e.jsx("div",{className:"bg-blue-500 h-3 rounded-full",style:{width:`${r.engagementMetrics.completionRate}%`}})})]})]}),e.jsxs(W,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Skip Rate"}),e.jsx(yt,{className:"w-5 h-5 text-red-600 dark:text-red-400"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:[r.engagementMetrics.skipRate.toFixed(1),"%"]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3",children:e.jsx("div",{className:"bg-red-500 h-3 rounded-full",style:{width:`${r.engagementMetrics.skipRate}%`}})})]})]}),e.jsxs(W,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Average Watch Time"}),e.jsx(Ae,{className:"w-5 h-5 text-green-600 dark:text-green-400"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:r.engagementMetrics.averageWatchTime}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"per session"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(W,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"User Interactions"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Repeat Views"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r.engagementMetrics.repeatViews.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Comments"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r.engagementMetrics.comments})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Likes"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:r.engagementMetrics.likes})]})]})]}),e.jsxs(W,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Engagement Quality"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsxs("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400 mb-1",children:[((r.engagementMetrics.completionRate+(100-r.engagementMetrics.skipRate))/2).toFixed(1),"%"]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Overall Engagement Score"})]}),e.jsxs("div",{className:"text-center p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400 mb-1",children:[(r.engagementMetrics.repeatViews/r.overview.viewCount*100).toFixed(1),"%"]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Repeat View Rate"})]})]})]})]})]}),E=[{id:"overview",label:"Overview",icon:We},{id:"activity",label:"Activity",icon:Fe},{id:"content",label:"Content",icon:Lt},{id:"sharing",label:"Sharing",icon:pe},{id:"engagement",label:"Engagement",icon:qt}];return e.jsx(M.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:a,children:e.jsxs(M.div,{initial:{y:20},animate:{y:0},className:"bg-white dark:bg-gray-900 rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-hidden",onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Collection Analytics"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t.name})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(v,{variant:"ghost",size:"sm",onClick:()=>A(!_),className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Compare"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>y("csv"),children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>y("json"),children:e.jsx(Ne,{className:"w-4 h-4"})})]}),e.jsx(v,{variant:"ghost",size:"sm",onClick:a,children:e.jsx(de,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsx("div",{className:"flex items-center px-6 overflow-x-auto",children:E.map(x=>{const f=x.icon;return e.jsxs("button",{onClick:()=>L(x.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors whitespace-nowrap ${k===x.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:[e.jsx(f,{className:"w-4 h-4"}),x.label]},x.id)})})}),e.jsx("div",{className:"overflow-y-auto p-6 max-h-[calc(90vh-140px)]",children:D?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs(e.Fragment,{children:[k==="overview"&&H(),k==="activity"&&O(),k==="content"&&V(),k==="sharing"&&z(),k==="engagement"&&F()]})})]})})},Kt=Object.freeze(Object.defineProperty({__proto__:null,CollectionAnalytics:Ht},Symbol.toStringTag,{value:"Module"})),ll=[{value:"1h",label:"1 Hour"},{value:"24h",label:"24 Hours"},{value:"7d",label:"7 Days"},{value:"30d",label:"30 Days"},{value:"90d",label:"90 Days"},{value:"never",label:"Never"}],ge=[{name:"View Only",description:"Can only view the collection",permissions:{can_view:!0,can_download:!1,can_comment:!1,can_edit:!1,can_reshare:!1}},{name:"View & Download",description:"Can view and download items",permissions:{can_view:!0,can_download:!0,can_comment:!1,can_edit:!1,can_reshare:!1}},{name:"Contributor",description:"Can view, download, and comment",permissions:{can_view:!0,can_download:!0,can_comment:!0,can_edit:!1,can_reshare:!1}},{name:"Editor",description:"Can view, download, comment, and edit",permissions:{can_view:!0,can_download:!0,can_comment:!0,can_edit:!0,can_reshare:!1}},{name:"Full Access",description:"Can do everything including reshare",permissions:{can_view:!0,can_download:!0,can_comment:!0,can_edit:!0,can_reshare:!0}}],rl=[{id:"link",name:"Share Link",description:"Create a shareable link",icon:Ut,color:"blue"},{id:"email",name:"Email Invite",description:"Send via email invitation",icon:st,color:"green"},{id:"embed",name:"Embed",description:"Get embed code for websites",icon:Ne,color:"purple"},{id:"qr",name:"QR Code",description:"Generate QR code for mobile",icon:Ye,color:"orange"}],il=({collection:t,onClose:a,onShareUpdate:s})=>{const[l,o]=n.useState("link"),[w,p]=n.useState([]),[N,_]=n.useState(!1),[A,k]=n.useState(ge[1]),[L,b]=n.useState("7d"),[D,S]=n.useState(!1),[r,c]=n.useState(""),[C,y]=n.useState(!0),[$,H]=n.useState(),[O,z]=n.useState(""),[V,F]=n.useState(""),[E,x]=n.useState({width:800,height:600}),[f,P]=n.useState(!1),[q,Q]=n.useState("disconnected");n.useEffect(()=>{const g=[{id:"1",title:"Public Share",url:`https://catalogizer.app/shared/${t.id}/abc123`,token:"abc123",permissions:ge[1].permissions,expires_in:"7d",created_at:new Date(Date.now()-864e5).toISOString(),access_count:25,is_active:!0},{id:"2",title:"Editor Access",url:`https://catalogizer.app/shared/${t.id}/def456`,token:"def456",permissions:ge[3].permissions,expires_in:"30d",created_at:new Date(Date.now()-6048e5).toISOString(),access_count:8,is_active:!0}];p(g)},[t.id]),n.useEffect(()=>{if(f){Q("connecting");const g=setTimeout(()=>{Q("connected")},1e3);return()=>clearTimeout(g)}else Q("disconnected")},[f]);const i=n.useCallback(async()=>{_(!0);try{await new Promise(U=>setTimeout(U,1500));const g={id:Date.now().toString(),title:`Share Link ${w.length+1}`,url:`https://catalogizer.app/shared/${t.id}/${Math.random().toString(36).substr(2,9)}`,token:Math.random().toString(36).substr(2,9),permissions:A.permissions,expires_in:L,created_at:new Date().toISOString(),access_count:0,is_active:!0};p(U=>[g,...U]),s==null||s(w.concat(g)),j.success("Share link created successfully"),k(ge[1]),b("7d"),S(!1),c(""),y(!0),H(void 0)}catch{j.error("Failed to create share link")}finally{_(!1)}},[t.id,A,L,D,r,C,$,w,s]),u=n.useCallback(g=>{navigator.clipboard.writeText(g),j.success("Copied to clipboard")},[]),T=n.useCallback(async g=>{try{await new Promise(U=>setTimeout(U,1e3)),p(U=>U.map(K=>K.id===g?{...K,is_active:!1}:K)),j.success("Share link revoked")}catch{j.error("Failed to revoke share link")}},[]),d=n.useCallback(async g=>{try{await new Promise(U=>setTimeout(U,1e3)),p(U=>U.filter(K=>K.id!==g)),j.success("Share link deleted")}catch{j.error("Failed to delete share link")}},[]),h=n.useCallback(async()=>{if(!O.trim()){j.error("Please enter at least one email address");return}try{await new Promise(U=>setTimeout(U,2e3));const g=O.split(",").map(U=>U.trim());j.success(`Invitation sent to ${g.length} recipient${g.length>1?"s":""}`),z(""),F("")}catch{j.error("Failed to send invitations")}},[O,V]),I=n.useCallback(()=>`<iframe src="${window.location.origin}/embed/${t.id}" width="${E.width}" height="${E.height}" frameborder="0" allowfullscreen></iframe>`,[t.id,E]),R=n.useCallback(()=>{const g=`https://catalogizer.app/shared/${t.id}/qr-${Date.now()}`;u(g),j.success("QR code URL copied to clipboard")},[t.id,u]),ne=({link:g})=>e.jsxs(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:g.title}),g.is_active?e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}):e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:g.url})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>u(g.url),title:"Copy link",children:e.jsx(Te,{className:"w-4 h-4"})}),e.jsx("a",{href:g.url,target:"_blank",title:"Open in new tab",className:"inline-flex",rel:"noreferrer",children:e.jsx(v,{variant:"ghost",size:"sm",type:"button",children:e.jsx(Za,{className:"w-4 h-4"})})})]})]}),e.jsx("div",{className:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400 mb-3",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:[g.access_count," views"]}),e.jsxs("span",{children:["Created ",new Date(g.created_at).toLocaleDateString()]}),e.jsxs("span",{children:["Expires in ",g.expires_in]})]})}),e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[g.permissions.can_view&&e.jsx("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 text-xs rounded",children:"View"}),g.permissions.can_download&&e.jsx("span",{className:"px-2 py-1 bg-green-100 dark:bg-green-900/20 text-green-600 dark:text-green-400 text-xs rounded",children:"Download"}),g.permissions.can_comment&&e.jsx("span",{className:"px-2 py-1 bg-purple-100 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400 text-xs rounded",children:"Comment"}),g.permissions.can_edit&&e.jsx("span",{className:"px-2 py-1 bg-orange-100 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 text-xs rounded",children:"Edit"}),g.permissions.can_reshare&&e.jsx("span",{className:"px-2 py-1 bg-red-100 dark:bg-red-900/20 text-red-600 dark:text-red-400 text-xs rounded",children:"Reshare"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[g.is_active&&e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>T(g.id),className:"text-yellow-600 border-yellow-600 hover:bg-yellow-50 dark:hover:bg-yellow-900/20",children:[e.jsx(Xe,{className:"w-4 h-4 mr-1"}),"Revoke"]}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>d(g.id),className:"text-red-600 border-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",children:[e.jsx(be,{className:"w-4 h-4 mr-1"}),"Delete"]})]})]});return e.jsx(M.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:a,children:e.jsxs(M.div,{initial:{y:20},animate:{y:0},className:"bg-white dark:bg-gray-900 rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden",onClick:g=>g.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Share Collection"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t.name})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(v,{variant:"ghost",size:"sm",onClick:()=>P(!f),className:`flex items-center gap-2 ${f?"text-green-600 dark:text-green-400":"text-gray-600 dark:text-gray-400"}`,children:[q==="connected"?e.jsx(Je,{className:"w-4 h-4"}):q==="connecting"?e.jsx(Ce,{className:"w-4 h-4 animate-spin"}):e.jsx(Ze,{className:"w-4 h-4"}),f?"Live":"Offline"]})}),e.jsx(v,{variant:"ghost",size:"sm",onClick:a,children:e.jsx(de,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsx("div",{className:"flex items-center px-6",children:rl.map(g=>{const U=g.icon;return e.jsxs("button",{onClick:()=>o(g.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${l===g.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:[e.jsx(U,{className:"w-4 h-4"}),g.name]},g.id)})})}),e.jsx("div",{className:"overflow-y-auto p-6 max-h-[calc(90vh-140px)]",children:e.jsxs(ie,{mode:"wait",children:[l==="link"&&e.jsxs(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[e.jsxs(W,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Create Share Link"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Permission Level"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:ge.map(g=>e.jsxs("button",{onClick:()=>k(g),className:`p-3 rounded-lg border-2 text-left transition-colors ${A.name===g.name?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:g.name}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:g.description})]},g.name))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Expires In"}),e.jsx(Z,{value:L,onChange:b,options:ll,className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Max Downloads"}),e.jsx(ce,{type:"number",placeholder:"Unlimited",value:$||"",onChange:g=>H(g.target.value?parseInt(g.target.value):void 0),min:"1"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"Require Password"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Users must enter a password to access"})]}),e.jsx(G,{checked:D,onCheckedChange:S})]}),D&&e.jsx(ce,{type:"password",placeholder:"Enter password",value:r,onChange:g=>c(g.target.value),className:"ml-4"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"Allow Anonymous Access"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Anyone with the link can access"})]}),e.jsx(G,{checked:C,onCheckedChange:y})]})]}),e.jsx(v,{onClick:i,disabled:N,className:"w-full",children:N?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Create Share Link"]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Active Shares"}),e.jsx("div",{className:"space-y-4",children:w.map(g=>e.jsx(ne,{link:g},g.id))})]})]},"link"),l==="email"&&e.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:e.jsxs(W,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Send Email Invitations"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Addresses"}),e.jsx(ce,{type:"email",placeholder:"Enter email addresses, separated by commas",value:O,onChange:g=>z(g.target.value),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Permission Level"}),e.jsx(Z,{value:A.name,onChange:g=>k(ge.find(U=>U.name===g)||ge[1]),options:ge.map(g=>({value:g.name,label:g.name})),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Personal Message (Optional)"}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",rows:4,placeholder:"Add a personal message to your invitation...",value:V,onChange:g=>F(g.target.value)})]}),e.jsxs(v,{onClick:h,className:"w-full",children:[e.jsx(st,{className:"w-4 h-4 mr-2"}),"Send Invitations"]})]})]})},"email"),l==="embed"&&e.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:e.jsxs(W,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Embed Collection"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Width (px)"}),e.jsx(ce,{type:"number",value:E.width,onChange:g=>x(U=>({...U,width:parseInt(g.target.value)||800})),min:"200",max:"1920"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Height (px)"}),e.jsx(ce,{type:"number",value:E.height,onChange:g=>x(U=>({...U,height:parseInt(g.target.value)||600})),min:"200",max:"1080"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Embed Code"}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white font-mono text-sm",rows:4,value:I(),readOnly:!0})]}),e.jsxs(v,{onClick:()=>u(I()),className:"w-full",children:[e.jsx(Te,{className:"w-4 h-4 mr-2"}),"Copy Embed Code"]})]})]})},"embed"),l==="qr"&&e.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:e.jsxs(W,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"QR Code Sharing"}),e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-64 h-64 bg-gray-100 dark:bg-gray-800 rounded-lg mx-auto flex items-center justify-center",children:e.jsx(Ye,{className:"w-32 h-32 text-gray-400"})}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Generate a QR code that mobile users can scan to quickly access this collection"}),e.jsxs(v,{onClick:R,className:"w-full max-w-xs",children:[e.jsx(Ye,{className:"w-4 h-4 mr-2"}),"Generate QR Code"]})]})]})},"qr")]})})]})})},Tt=[{value:"json",label:"JSON",description:"Structured data format with full metadata",icon:Ya,extensions:[".json"],supportsMetadata:!0,supportsFiles:!0},{value:"csv",label:"CSV",description:"Spreadsheet format for basic data",icon:Xa,extensions:[".csv"],supportsMetadata:!0,supportsFiles:!1},{value:"m3u",label:"M3U Playlist",description:"Standard playlist format for media players",icon:Le,extensions:[".m3u",".m3u8"],supportsMetadata:!1,supportsFiles:!1},{value:"xspf",label:"XSPF Playlist",description:"XML Shareable Playlist Format",icon:ve,extensions:[".xspf"],supportsMetadata:!0,supportsFiles:!1},{value:"wpl",label:"WPL Playlist",description:"Windows Media Player playlist",icon:es,extensions:[".wpl"],supportsMetadata:!1,supportsFiles:!1},{value:"zip",label:"ZIP Archive",description:"Complete collection with files",icon:zt,extensions:[".zip"],supportsMetadata:!0,supportsFiles:!0}],nl=[{value:"none",label:"No Compression",description:"Original file size"},{value:"zip",label:"ZIP",description:"Standard compression"},{value:"tar",label:"TAR",description:"Unix archive format"},{value:"7z",label:"7-Zip",description:"Best compression ratio"}],cl=[{value:"original",label:"Original Quality",description:"No quality loss"},{value:"high",label:"High Quality",description:"Slight compression for better size"},{value:"medium",label:"Medium Quality",description:"Balanced quality and size"},{value:"low",label:"Low Quality",description:"Maximum compression"}],ol=[{value:"audio",label:"Audio Files",extensions:[".mp3",".wav",".flac",".m4a"]},{value:"video",label:"Video Files",extensions:[".mp4",".avi",".mkv",".mov"]},{value:"image",label:"Image Files",extensions:[".jpg",".png",".gif",".webp"]},{value:"document",label:"Documents",extensions:[".pdf",".doc",".txt"]}],dl=({collection:t,onClose:a})=>{const[s,l]=n.useState("export"),[o,w]=n.useState({format:"json",includeMetadata:!0,includeThumbnails:!1,includeFiles:!1,compression:"none",quality:"original",maxFileSize:null,fileTypes:[],dateRange:null,customFields:[]}),[p,N]=n.useState({format:"json",mergeStrategy:"merge",duplicateHandling:"skip",preserveIds:!1,validateData:!0,createBackup:!0,mapping:{}}),[_,A]=n.useState(!1),[k,L]=n.useState(!1),[b,D]=n.useState(null),[S,r]=n.useState(null),[c,C]=n.useState(null),[y,$]=n.useState(!1),[H,O]=n.useState(""),[z,V]=n.useState([]),F=n.useRef(null),{collectionItems:E,isLoading:x}=qe((t==null?void 0:t.id)||""),f=E||[],P=Tt.find(d=>d.value===o.format),q=n.useCallback(async()=>{A(!0),D({stage:"Preparing export",progress:0,total:f.length});try{for(let K=0;K<=100;K+=10)await new Promise(ee=>setTimeout(ee,200)),D(ee=>ee?{...ee,progress:Math.floor(f.length*K/100),stage:K<30?"Preparing files":K<70?"Processing items":K<90?"Generating export":"Finalizing"}:null);const d={collection:{id:t.id,name:t.name,description:t.description,created_at:t.created_at,updated_at:t.updated_at},items:f.map(K=>({id:K.id,title:K.title||K.name,type:K.media_type,path:K.path,size:K.size,duration:K.duration,rating:K.rating,metadata:o.includeMetadata?K.metadata:void 0,thumbnail:o.includeThumbnails?K.thumbnail:void 0})),exported_at:new Date().toISOString(),export_options:o};let h=`${t.name.replace(/[^a-z0-9]/gi,"_")}_${Date.now()}`,I="application/json",R=JSON.stringify(d,null,2);o.format==="csv"?(R=[["id","title","type","path","size","duration","rating"].join(","),...f.map(te=>[te.id,`"${te.title||te.name}"`,te.media_type,`"${te.path}"`,te.size||0,te.duration||0,te.rating||0].join(","))].join(`
`),I="text/csv",h+=".csv"):o.format==="m3u"?(R=["#EXTM3U",...f.map(ee=>`#EXTINF:${ee.duration||0},${ee.title||ee.name}
${ee.path}`)].join(`
`),I="audio/x-mpegurl",h+=".m3u"):h+=".json";const ne=new Blob([R],{type:I}),g=URL.createObjectURL(ne),U=document.createElement("a");U.href=g,U.download=h,U.click(),URL.revokeObjectURL(g),j.success("Collection exported successfully")}catch(d){j.error("Export failed"),console.error("Export error:",d)}finally{A(!1),D(null)}},[t,f,o]),Q=n.useCallback(d=>{var I;const h=(I=d.target.files)==null?void 0:I[0];if(h){C(h);const R=new FileReader;R.onload=ne=>{var g,U,K,ee;try{const te=(g=ne.target)==null?void 0:g.result;let me;if(h.name.endsWith(".json"))me=JSON.parse(te);else if(h.name.endsWith(".csv")){const De=te.split(`
`),Ue=De[0].split(",");me={items:De.slice(1).map(_e=>{const Be=_e.split(",");return Ue.reduce((Ee,Ve,Qe)=>{var Oe;return Ee[Ve.trim()]=((Oe=Be[Qe])==null?void 0:Oe.replace(/"/g,""))||"",Ee},{})}).filter(_e=>_e.title)}}const Pe={totalItems:((U=me.items)==null?void 0:U.length)||0,validItems:((K=me.items)==null?void 0:K.length)||0,invalidItems:0,duplicates:0,newItems:((ee=me.items)==null?void 0:ee.length)||0,sampleItems:(me.items||[]).slice(0,5),conflicts:[]};r(Pe)}catch{j.error("Failed to parse import file"),r(null)}},R.readAsText(h)}},[]),i=n.useCallback(async()=>{if(!(!c||!S)){L(!0);try{await new Promise(d=>setTimeout(d,2e3)),j.success(`Successfully imported ${S.newItems} items`),C(null),r(null),F.current&&(F.current.value="")}catch(d){j.error("Import failed"),console.error("Import error:",d)}finally{L(!1)}}},[c,S]),u=d=>{if(d===0)return"0 B";const h=1024,I=["B","KB","MB","GB","TB"],R=Math.floor(Math.log(d)/Math.log(h));return parseFloat((d/Math.pow(h,R)).toFixed(2))+" "+I[R]},T=({format:d,isSelected:h,onClick:I})=>e.jsx(M.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:I,className:`p-4 rounded-lg border-2 text-left transition-colors ${h?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${h?"bg-blue-100 dark:bg-blue-900/40":"bg-gray-100 dark:bg-gray-800"}`,children:e.jsx(d.icon,{className:`w-5 h-5 ${h?"text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400"}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:d.label}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:d.description}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:d.extensions.map(R=>e.jsx("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-800 text-xs rounded text-gray-600 dark:text-gray-400",children:R},R))})]})]})});return e.jsx(M.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:a,children:e.jsxs(M.div,{initial:{y:20},animate:{y:0},className:"bg-white dark:bg-gray-900 rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden",onClick:d=>d.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Export / Import Collection"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t.name})]}),e.jsx(v,{variant:"ghost",size:"sm",onClick:a,children:e.jsx(de,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center px-6",children:[e.jsxs("button",{onClick:()=>l("export"),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${s==="export"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:[e.jsx(oe,{className:"w-4 h-4"}),"Export"]}),e.jsxs("button",{onClick:()=>l("import"),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors ${s==="import"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:[e.jsx(Ne,{className:"w-4 h-4"}),"Import"]})]})}),e.jsx("div",{className:"overflow-y-auto p-6 max-h-[calc(90vh-140px)]",children:e.jsxs(ie,{mode:"wait",children:[s==="export"&&e.jsxs(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[e.jsxs(W,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Export Format"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Tt.map(d=>e.jsx(T,{format:d,isSelected:o.format===d.value,onClick:()=>w(h=>({...h,format:d.value}))},d.value))})]}),e.jsxs(W,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Export Options"}),e.jsxs(v,{variant:"ghost",size:"sm",onClick:()=>$(!y),className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-4 h-4"}),y?"Hide":"Show"," Advanced"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"Include Metadata"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Export tags, ratings, and custom fields"})]}),e.jsx(G,{checked:o.includeMetadata,onCheckedChange:d=>w(h=>({...h,includeMetadata:d})),disabled:!(P!=null&&P.supportsMetadata)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"Include Thumbnails"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Export thumbnail images"})]}),e.jsx(G,{checked:o.includeThumbnails,onCheckedChange:d=>w(h=>({...h,includeThumbnails:d}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"Include Files"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Export actual media files"})]}),e.jsx(G,{checked:o.includeFiles,onCheckedChange:d=>w(h=>({...h,includeFiles:d})),disabled:!(P!=null&&P.supportsFiles)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"Create Backup"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Keep original data intact"})]}),e.jsx(G,{checked:!0,disabled:!0})]})]}),e.jsx(ie,{children:y&&e.jsx(M.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4 border-t border-gray-200 dark:border-gray-700 pt-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Compression"}),e.jsx(Z,{value:o.compression,onChange:d=>w(h=>({...h,compression:d})),options:nl,className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Quality"}),e.jsx(Z,{value:o.quality,onChange:d=>w(h=>({...h,quality:d})),options:cl,className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Max File Size (MB)"}),e.jsx(ce,{type:"number",placeholder:"No limit",value:o.maxFileSize||"",onChange:d=>w(h=>({...h,maxFileSize:d.target.value?parseInt(d.target.value):null})),min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"File Types"}),e.jsx("div",{className:"space-y-2",children:ol.map(d=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:o.fileTypes.includes(d.value),onChange:h=>{h.target.checked?w(I=>({...I,fileTypes:[...I.fileTypes,d.value]})):w(I=>({...I,fileTypes:I.fileTypes.filter(R=>R!==d.value)}))},className:"rounded border-gray-300 dark:border-gray-600"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:d.label})]},d.value))})]})]})})}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"Collection Summary"}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[f.length," items  ",u(f.reduce((d,h)=>d+(h.size||0),0))]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"Est. Export Size"}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["~",u(f.reduce((d,h)=>d+(h.size||0),0))]})]})]})})]})]}),b&&e.jsxs(W,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Export Progress"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:b.stage}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[b.progress," / ",b.total]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx(M.div,{className:"bg-blue-500 h-2 rounded-full",initial:{width:0},animate:{width:`${b.progress/b.total*100}%`},transition:{duration:.3}})}),b.currentFile&&e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Processing: ",b.currentFile]})]})]}),e.jsx(v,{onClick:q,disabled:_||x,className:"w-full",children:_?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"w-4 h-4 mr-2 animate-spin"}),"Exporting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Export Collection"]})})]},"export"),s==="import"&&e.jsxs(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[e.jsxs(W,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Import File"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{onClick:()=>{var d;return(d=F.current)==null?void 0:d.click()},className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center cursor-pointer hover:border-blue-500 transition-colors",children:[e.jsx(Ne,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-900 dark:text-white font-medium mb-2",children:"Click to upload or drag and drop"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"JSON, CSV, M3U, or ZIP files"}),e.jsx("input",{ref:F,type:"file",accept:".json,.csv,.m3u,.m3u8,.zip",onChange:Q,className:"hidden"})]}),c&&e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:c.name}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:u(c.size)})]})]}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>{C(null),r(null),F.current&&(F.current.value="")},children:e.jsx(de,{className:"w-4 h-4"})})]})})]})]}),c&&e.jsxs(W,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Import Options"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Merge Strategy"}),e.jsx(Z,{value:p.mergeStrategy,onChange:d=>N(h=>({...h,mergeStrategy:d})),options:[{value:"replace",label:"Replace Collection"},{value:"merge",label:"Merge with Existing"},{value:"append",label:"Append to Collection"}],className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Duplicate Handling"}),e.jsx(Z,{value:p.duplicateHandling,onChange:d=>N(h=>({...h,duplicateHandling:d})),options:[{value:"skip",label:"Skip Duplicates"},{value:"replace",label:"Replace Existing"},{value:"rename",label:"Rename Imports"},{value:"merge",label:"Merge Data"}],className:"w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"Preserve IDs"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Keep original item IDs"})]}),e.jsx(G,{checked:p.preserveIds,onCheckedChange:d=>N(h=>({...h,preserveIds:d}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"Validate Data"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Check for errors"})]}),e.jsx(G,{checked:p.validateData,onCheckedChange:d=>N(h=>({...h,validateData:d}))})]})]})]})]}),S&&e.jsxs(W,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Import Preview"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:S.totalItems}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Items"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:S.newItems}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"New Items"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:S.duplicates}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Duplicates"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:S.invalidItems}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Invalid Items"})]})]}),S.sampleItems.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Sample Items"}),e.jsx("div",{className:"space-y-2",children:S.sampleItems.map((d,h)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:d.title||d.name||"Unknown"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:d.path||"No path"})]}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:d.type||"Unknown type"})]},h))})]})]}),c&&S&&e.jsx(v,{onClick:i,disabled:k,className:"w-full",children:k?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"w-4 h-4 mr-2 animate-spin"}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Import Collection"]})})]},"import")]})})]})})},Mt={user_joined:cs,user_left:ns,item_added:is,item_removed:rs,item_updated:ls,item_deleted:be,download_started:oe,playback_started:Me,comment_added:ss,share_created:pe,rating_added:Et},ml={user_joined:t=>`${t} joined the collection`,user_left:t=>`${t} left the collection`,item_added:(t,a)=>`${t} added "${a}"`,item_removed:(t,a)=>`${t} removed "${a}"`,item_updated:(t,a)=>`${t} updated "${a}"`,item_deleted:(t,a)=>`${t} deleted "${a}"`,download_started:(t,a)=>`${t} started downloading "${a}"`,playback_started:(t,a)=>`${t} started playing "${a}"`,comment_added:(t,a)=>`${t} commented on "${a}"`,share_created:t=>`${t} shared this collection`,rating_added:(t,a,s)=>`${t} rated "${a}" ${s} stars`},xl=({collection:t,onClose:a})=>{const[s,l]=n.useState(!1),[o,w]=n.useState({status:"disconnected"}),[p,N]=n.useState([]),[_,A]=n.useState([]),[k,L]=n.useState(!0),[b,D]=n.useState({userActivity:!0,itemChanges:!0,playbackActivity:!0,commentsAndShares:!0,systemNotifications:!0,soundEnabled:!0,desktopNotifications:!1}),[S,r]=n.useState(!0),[c,C]=n.useState(!0),[y,$]=n.useState({activeUsers:0,totalInteractions:0,recentActivity:0,peakConcurrent:0});n.useRef(null);const H=n.useRef(null),O=n.useRef(null);qe((t==null?void 0:t.id)||"");const z=n.useCallback(()=>{w({status:"connecting"}),setTimeout(()=>{l(!0),w({status:"connected",latency:Math.floor(Math.random()*50)+20,messageCount:0,lastConnected:new Date().toISOString()});const i=[{id:"1",name:"You",avatar:void 0,status:"active",lastSeen:new Date().toISOString(),isCurrentUser:!0},{id:"2",name:"John Doe",avatar:void 0,status:"active",lastSeen:new Date().toISOString(),currentActivity:"Browsing items"},{id:"3",name:"Jane Smith",avatar:void 0,status:"away",lastSeen:new Date(Date.now()-3e5).toISOString(),currentActivity:"Away"}];N(i);const u=[{id:"1",type:"user_joined",timestamp:new Date(Date.now()-3e5).toISOString(),userId:"2",userName:"John Doe",data:{},collectionId:t.id,collectionName:t.name},{id:"2",type:"item_added",timestamp:new Date(Date.now()-18e4).toISOString(),userId:"2",userName:"John Doe",data:{itemId:"item123",itemTitle:"Summer Mix 2024",itemType:"music"},collectionId:t.id,collectionName:t.name},{id:"3",type:"playback_started",timestamp:new Date(Date.now()-6e4).toISOString(),userId:"3",userName:"Jane Smith",data:{itemId:"item456",itemTitle:"Presentation Video",itemType:"video"},collectionId:t.id,collectionName:t.name}];A(u),$({activeUsers:i.length,totalInteractions:u.length,recentActivity:3,peakConcurrent:5})},1e3)},[t.id,t.name]),V=n.useCallback(()=>{l(!1),w({status:"disconnected"}),N([]),H.current&&clearTimeout(H.current),O.current&&clearInterval(O.current)},[]),F=n.useCallback(()=>{s?V():z()},[s,z,V]);n.useEffect(()=>(z(),()=>{V()}),[z,V]),n.useEffect(()=>{if(!s)return;const i=setInterval(()=>{const u=Object.keys(Mt),T=u[Math.floor(Math.random()*u.length)],d={id:Date.now().toString(),type:T,timestamp:new Date().toISOString(),userId:Math.random().toString(),userName:["John Doe","Jane Smith","Bob Wilson"][Math.floor(Math.random()*3)],data:{itemId:Math.random().toString(),itemTitle:`Item ${Math.floor(Math.random()*100)}`,itemType:["music","video","image"][Math.floor(Math.random()*3)]},collectionId:t.id,collectionName:t.name};if(A(h=>[d,...h.slice(0,49)]),$(h=>({...h,totalInteractions:h.totalInteractions+1,recentActivity:h.recentActivity+1})),k&&b[E(T)]){const h=x(d);if(b.desktopNotifications&&"Notification"in window&&new Notification(h,{body:t.name,icon:"/favicon.ico"}),b.soundEnabled){const I=new Audio("/notification.mp3");I.volume=.3,I.play().catch(()=>{})}j(h)}},Math.random()*1e4+5e3);return()=>clearInterval(i)},[s,t,k,b]);const E=i=>["user_joined","user_left"].includes(i)?"userActivity":["item_added","item_removed","item_updated","item_deleted"].includes(i)?"itemChanges":["download_started","playback_started"].includes(i)?"playbackActivity":["comment_added","share_created","rating_added"].includes(i)?"commentsAndShares":"systemNotifications",x=i=>{var T;const u=ml[i.type];return u?i.type==="rating_added"?u(i.userName,i.data.itemTitle||"",((T=i.data.details)==null?void 0:T.rating)||5):i.type==="user_joined"||i.type==="user_left"||i.type==="share_created"?u(i.userName):u(i.userName,i.data.itemTitle||""):`${i.userName} performed an action`},f=i=>{const u=new Date(i),d=new Date().getTime()-u.getTime(),h=Math.floor(d/6e4);if(h<1)return"Just now";if(h<60)return`${h}m ago`;const I=Math.floor(h/60);return I<24?`${I}h ago`:u.toLocaleDateString()},P=n.useCallback(async()=>{"Notification"in window&&Notification.permission==="default"&&(await Notification.requestPermission(),D(i=>({...i,desktopNotifications:!0})))},[]),q=({event:i})=>{const u=Mt[i.type];return e.jsxs(M.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex items-start gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:e.jsx(u,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:x(i)}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:f(i.timestamp)})]})]})},Q=({user:i})=>e.jsxs("div",{className:"flex items-center gap-3 p-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:i.name.charAt(0)}),e.jsx("div",{className:`absolute bottom-0 right-0 w-2.5 h-2.5 rounded-full border-2 border-white dark:border-gray-900 ${i.status==="active"?"bg-green-500":i.status==="away"?"bg-yellow-500":"bg-gray-400"}`})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[i.name," ",i.isCurrentUser&&"(You)"]}),i.currentActivity&&e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 truncate",children:i.currentActivity})]})]});return e.jsx(M.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:a,children:e.jsxs(M.div,{initial:{y:20},animate:{y:0},className:"bg-white dark:bg-gray-900 rounded-xl shadow-2xl max-w-5xl w-full max-h-[90vh] overflow-hidden",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Real-time Collection"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t.name})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-lg ${o.status==="connected"?"bg-green-100 dark:bg-green-900/20 text-green-600 dark:text-green-400":o.status==="connecting"?"bg-yellow-100 dark:bg-yellow-900/20 text-yellow-600 dark:text-yellow-400":"bg-red-100 dark:bg-red-900/20 text-red-600 dark:text-red-400"}`,children:[o.status==="connected"?e.jsx(Je,{className:"w-4 h-4"}):o.status==="connecting"?e.jsx(Ce,{className:"w-4 h-4 animate-spin"}):e.jsx(Ze,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:o.status.charAt(0).toUpperCase()+o.status.slice(1)})]}),o.latency&&e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[o.latency,"ms"]})]}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>L(!k),className:`flex items-center gap-2 ${k?"text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400"}`,children:k?e.jsx(ts,{className:"w-4 h-4"}):e.jsx(as,{className:"w-4 h-4"})}),a&&e.jsx(v,{variant:"ghost",size:"sm",onClick:a,children:e.jsx(de,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"overflow-y-auto p-6 max-h-[calc(90vh-140px)]",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs(W,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:"Connection"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(v,{onClick:F,className:`w-full ${s?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:s?e.jsxs(e.Fragment,{children:[e.jsx(Ze,{className:"w-4 h-4 mr-2"}),"Disconnect"]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Connect"]})}),o.lastConnected&&e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Last connected: ",f(o.lastConnected)]})]})]}),e.jsxs(W,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:"Activity Stats"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Active Users"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:y.activeUsers})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Interactions"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:y.totalInteractions})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Recent Activity"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:y.recentActivity})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Peak Concurrent"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:y.peakConcurrent})]})]})]}),e.jsxs(W,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:"Notifications"}),e.jsxs("div",{className:"space-y-3",children:[Object.entries({userActivity:"User Activity",itemChanges:"Item Changes",playbackActivity:"Playback Activity",commentsAndShares:"Comments & Shares"}).map(([i,u])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:u}),e.jsx(G,{checked:b[i],onCheckedChange:T=>D(d=>({...d,[i]:T}))})]},i)),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Sound"}),e.jsx(G,{checked:b.soundEnabled,onCheckedChange:i=>D(u=>({...u,soundEnabled:i}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Desktop"}),b.desktopNotifications?e.jsx(G,{checked:!0,onCheckedChange:()=>D(i=>({...i,desktopNotifications:!1}))}):e.jsx(v,{variant:"ghost",size:"sm",onClick:P,className:"text-xs",children:"Enable"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white",children:["Online Users (",p.length,")"]}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>r(!S),children:S?e.jsx(Xe,{className:"w-4 h-4"}):e.jsx(ke,{className:"w-4 h-4"})})]}),e.jsx(ie,{children:S&&e.jsx(M.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:e.jsx(W,{className:"p-4",children:e.jsx("div",{className:"space-y-2",children:p.map(i=>e.jsx(Q,{user:i},i.id))})})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Recent Events"}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>C(!c),children:c?e.jsx(Xe,{className:"w-4 h-4"}):e.jsx(ke,{className:"w-4 h-4"})})]}),e.jsx(ie,{children:c&&e.jsx(M.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:e.jsx(W,{className:"p-4",children:e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:_.length===0?e.jsxs("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:[e.jsx(Fe,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("p",{children:"No recent activity"})]}):_.slice(0,20).map(i=>e.jsx(q,{event:i},i.id))})})})})]})]})})]})})},hl=n.lazy(()=>se(()=>import("./CollectionTemplates-BKdhYM22.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),ul=n.lazy(()=>se(()=>import("./AdvancedSearch-DdOS6g_3.js"),__vite__mapDeps([10,1,2,3,4,5,6,7,8,9,11,12]))),gl=n.lazy(()=>se(()=>import("./CollectionAutomation-BimCuQMf.js"),__vite__mapDeps([13,1,2,3,4,5,6,7,9,8,11,12]))),pl=n.lazy(()=>se(()=>import("./ExternalIntegrations-gZ1Ms1Ab.js"),__vite__mapDeps([14,1,2,3,4,5,6,7,9,8,11,12])));n.lazy(()=>se(()=>Promise.resolve().then(()=>Vt),void 0).then(t=>({default:t.SmartCollectionBuilder})));n.lazy(()=>se(()=>Promise.resolve().then(()=>Kt),void 0).then(t=>({default:t.CollectionAnalytics})));n.lazy(()=>se(()=>Promise.resolve().then(()=>Qt),void 0));const He=t=>{switch(t){case"CollectionTemplates":se(()=>import("./CollectionTemplates-BKdhYM22.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]));break;case"AdvancedSearch":se(()=>import("./AdvancedSearch-DdOS6g_3.js"),__vite__mapDeps([10,1,2,3,4,5,6,7,8,9,11,12]));break;case"CollectionAutomation":se(()=>import("./CollectionAutomation-BimCuQMf.js"),__vite__mapDeps([13,1,2,3,4,5,6,7,9,8,11,12]));break;case"ExternalIntegrations":se(()=>import("./ExternalIntegrations-gZ1Ms1Ab.js"),__vite__mapDeps([14,1,2,3,4,5,6,7,9,8,11,12]));break;case"SmartCollectionBuilder":se(()=>Promise.resolve().then(()=>Vt),void 0);break;case"CollectionAnalytics":se(()=>Promise.resolve().then(()=>Kt),void 0);break;case"BulkOperations":se(()=>Promise.resolve().then(()=>Qt),void 0);break}};us();class yl{constructor(a=100,s=6e4){Ie(this,"cache",{});Ie(this,"maxSize");Ie(this,"cleanupInterval");this.maxSize=a,this.cleanupInterval=setInterval(()=>this.cleanup(),s)}get(a){const s=this.cache[a];return s?Date.now()-s.timestamp>s.ttl?(delete this.cache[a],null):s.value:null}set(a,s,l=3e5){if(Object.keys(this.cache).length>=this.maxSize){const o=Object.keys(this.cache).reduce((w,p)=>this.cache[p].timestamp<this.cache[w].timestamp?p:w);delete this.cache[o]}this.cache[a]={value:s,timestamp:Date.now(),ttl:l}}cleanup(){const a=Date.now();Object.keys(this.cache).forEach(s=>{a-this.cache[s].timestamp>this.cache[s].ttl&&delete this.cache[s]})}clear(){this.cache={}}destroy(){clearInterval(this.cleanupInterval),this.clear()}}const Pt=new yl,rt=(t,a,s,l=3e5)=>{const o=s||a.map(N=>String(N)).join("|"),w=n.useMemo(t,a),p=Pt.get(o);return p!==null?p:(Pt.set(o,w,l),w)},bl=(t,a,s,l="asc")=>{const o=`${JSON.stringify(a)}-${s}-${l}`;return rt(()=>{let p=[...t];return Object.entries(a).forEach(([N,_])=>{_!=null&&_!==""&&(p=p.filter(A=>{const k=A[N];return typeof _=="string"?String(k).toLowerCase().includes(_.toLowerCase()):k===_}))}),s&&p.sort((N,_)=>{const A=N[s],k=_[s];return A==null?l==="asc"?-1:1:k==null?l==="asc"?1:-1:typeof A=="string"&&typeof k=="string"?l==="asc"?A.localeCompare(k):k.localeCompare(A):typeof A=="number"&&typeof k=="number"?l==="asc"?A-k:k-A:0}),p},[t,o])},vl=(t,a,s=1)=>{const[l,o]=n.useState(s),w=`pagination-${l}-${a}`,p=rt(()=>{const D=(l-1)*a,S=D+a;return t.slice(D,S)},[t,l,a],w),N=Math.ceil(t.length/a),_=l<N,A=l>1,k=n.useCallback(()=>{o(D=>Math.min(D+1,N))},[N]),L=n.useCallback(()=>{o(D=>Math.max(D-1,1))},[]),b=n.useCallback(D=>{o(Math.max(1,Math.min(D,N)))},[N]);return{page:l,setPage:o,paginatedData:p,totalPages:N,hasNextPage:_,hasPrevPage:A,nextPage:k,prevPage:L,goToPage:b}},fl=[{id:"all",label:"All Collections"},{id:"smart",label:"Smart Collections"},{id:"manual",label:"Manual Collections"},{id:"favorites",label:"Favorites"},{id:"templates",label:"Templates"},{id:"automation",label:"Automation"},{id:"integrations",label:"Integrations"},{id:"ai",label:"AI Features"}],jl=[{value:"all",label:"All Media"},{value:"music",label:"Music"},{value:"video",label:"Video"},{value:"image",label:"Images"},{value:"document",label:"Documents"}],wl=[{value:"grid",label:"Grid View",icon:ze},{value:"list",label:"List View",icon:Ft}],Nl=[{value:"name",label:"Name"},{value:"created_at",label:"Date Created"},{value:"updated_at",label:"Date Updated"},{value:"item_count",label:"Item Count"}],kl=()=>{const[t,a]=n.useState("all"),[s,l]=n.useState(""),[o,w]=n.useState("all"),[p,N]=n.useState("name"),[_,A]=n.useState("grid"),[k,L]=n.useState(!1),[b,D]=n.useState(null),[S,r]=n.useState(null),[c,C]=n.useState([]),[y,$]=n.useState(!1),[H,O]=n.useState(!1),[z,V]=n.useState(!1),[F,E]=n.useState(!1),[x,f]=n.useState(!1),[P,q]=n.useState(!1),[Q,i]=n.useState(!1),[u,T]=n.useState(!1),[d,h]=n.useState(!1),[I,R]=n.useState(!1),[ne,g]=n.useState(!1),[U,K]=n.useState(!1),[ee,te]=n.useState({bundleSize:0,renderTime:0,memoryUsage:0,cacheHitRate:0}),me=n.useCallback(m=>{const B=performance.now();return()=>{const Se=performance.now()-B;te(Ma=>({...Ma,renderTime:Se}))}},[]),{collections:Pe,isLoading:De,createCollection:Ue,updateCollection:_e,deleteCollection:Be,shareCollection:Ee,duplicateCollection:Ve,bulkDeleteCollections:Qe,bulkShareCollections:Oe,bulkExportCollections:Gt,bulkUpdateCollections:Wt,isSharing:Jt,isDuplicating:Zt}=qs(),[it,Yt]=n.useState(s),[nt,ct]=n.useState(!1);fe.useEffect(()=>{ct(!0);const m=setTimeout(()=>{Yt(s),ct(!1)},300);return()=>clearTimeout(m)},[s]);const Xt=rt(()=>({activeTab:t,searchQuery:it,filterMediaType:o}),[t,it,o]),le=bl(Pe,Xt,p),{page:xe,paginatedData:ot,totalPages:ye,nextPage:ea,prevPage:ta,goToPage:aa}=vl(le,20),sa=n.useCallback(m=>{l(m)},[]);fe.useEffect(()=>{const m=me("Collections Page");return()=>{m()}},[t,le.length,me]),fe.useEffect(()=>{switch(t){case"templates":He("CollectionTemplates");break;case"automation":He("CollectionAutomation");break;case"integrations":He("ExternalIntegrations");break}},[t]);const dt=n.useCallback((m,B)=>{C(J=>B?[...J,m]:J.filter(Se=>Se!==m))},[]),la=n.useCallback(()=>{C(U?[]:le.map(m=>m.id)),K(!U)},[U,le]),mt=()=>{C([]),K(!1)},xt=m=>{r(m)},ra=()=>{r(null)},ht=m=>{D(m),O(!0)},ut=()=>{L(!0)},ia=async(m,B,J)=>{try{await Ue({collection:{name:m,description:B,is_public:!1,is_smart:!0,smart_rules:J}}),L(!1)}catch(Se){console.error("Failed to create smart collection:",Se)}},na=async m=>{try{await Ee({id:m.id,shareRequest:{can_view:!0,can_comment:!1,can_download:!1}})}catch(B){console.error("Failed to share collection:",B)}},ca=async m=>{try{await Ve({id:m.id,newName:`${m.name} (Copy)`})}catch(B){console.error("Failed to duplicate collection:",B)}},gt=async m=>{if(window.confirm(`Are you sure you want to delete "${m.name}"? This action cannot be undone.`))try{await Be({id:m.id}),j.success("Collection deleted successfully")}catch(B){console.error("Failed to delete collection:",B),j.error("Failed to delete collection")}},oa=async(m,B)=>{try{switch(m){case"delete":await Qe({collectionIds:c}),j.success(`${c.length} collections deleted`);break;case"share":await Oe({collectionIds:c,shareRequest:B||{can_view:!0,can_comment:!1,can_download:!1}}),j.success(`${c.length} collections shared`);break;case"export":await Gt({collectionIds:c,format:(B==null?void 0:B.format)||"json"}),j.success(`${c.length} collections exported`);break;case"duplicate":await Wt({collectionIds:c,action:"duplicate"}),j.success(`${c.length} collections duplicated`);break;default:j.error("Unknown operation")}mt()}catch(J){console.error("Bulk operation failed:",J),j.error("Bulk operation failed")}},da=m=>{D(m),V(!0)},ma=m=>{D(m),E(!0)},xa=m=>{D(m),f(!0)},ha=m=>{D(m),q(!0)},ua=()=>{i(!0)},ga=()=>{T(!0)},pa=()=>{h(!0)},ya=()=>{R(!0)},ba=()=>{g(!0)},va=m=>{j.success(`AI suggestion applied: ${m.title}`)},fa=m=>{j.success(`AI search executed: ${m.query}`)},ja=m=>{j.success(`Content categorized as: ${m.category}`)},wa=m=>{j.success(`AI action implemented: ${m}`)},Na=(m,B)=>{j.success(`AI prediction action executed: ${B}`)},ka=m=>{j.success(`AI organization suggestion applied: ${m}`)},Ca=m=>{j.success("AI metadata extraction completed")},_a=(m,B)=>{j.success(`AI rule ${B?"enabled":"disabled"}: ${m}`)},Sa=m=>{j.success(`AI rule executed: ${m}`)},Ia=m=>{j.success(`AI quality improvement applied: ${m}`)},Aa=m=>{const B=c.includes(m.id);return e.jsxs(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},whileHover:{scale:1.02},className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4 cursor-pointer hover:shadow-md transition-shadow relative",children:[e.jsx("div",{className:"absolute top-2 left-2 z-10",children:e.jsx("button",{onClick:J=>{J.stopPropagation(),dt(m.id,!B)},className:`w-6 h-6 rounded-md border-2 flex items-center justify-center transition-colors ${B?"bg-blue-600 border-blue-600 text-white":"border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 hover:border-blue-400"}`,children:B&&e.jsx(ft,{className:"w-4 h-4"})})}),e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 ml-8",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:m.name}),m.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-2",children:m.description})]}),e.jsx("div",{className:"flex items-center gap-1",children:m.is_smart&&e.jsx("div",{className:"w-6 h-6 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center",children:e.jsx(Ae,{className:"w-3 h-3 text-purple-600 dark:text-purple-400"})})})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:[m.item_count," items"]}),e.jsx("span",{children:new Date(m.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{variant:"ghost",size:"sm",onClick:J=>{J.stopPropagation(),xt(m)},title:"Preview collection",children:e.jsx(ke,{className:"w-4 h-4"})}),e.jsx(v,{variant:"ghost",size:"sm",onClick:J=>{J.stopPropagation(),na(m)},disabled:Jt,title:"Share collection",children:e.jsx(hs,{className:"w-4 h-4"})}),e.jsx(v,{variant:"ghost",size:"sm",onClick:J=>{J.stopPropagation(),ca(m)},disabled:Zt,title:"Duplicate collection",children:e.jsx(Te,{className:"w-4 h-4"})}),e.jsx(v,{variant:"ghost",size:"sm",onClick:J=>{J.stopPropagation(),ht(m)},title:"Collection settings",children:e.jsx($e,{className:"w-4 h-4"})})]}),e.jsx(v,{variant:"ghost",size:"sm",onClick:J=>{J.stopPropagation(),gt(m)},className:"text-red-600 hover:text-red-700",title:"Delete collection",children:e.jsx(be,{className:"w-4 h-4"})})]})]},m.id)},Ta=m=>{const B=c.includes(m.id);return e.jsx(M.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("button",{onClick:()=>dt(m.id,!B),className:`w-6 h-6 rounded-md border-2 flex items-center justify-center transition-colors ${B?"bg-blue-600 border-blue-600 text-white":"border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 hover:border-blue-400"}`,children:B&&e.jsx(ft,{className:"w-4 h-4"})}),e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg flex items-center justify-center",children:m.is_smart?e.jsx(Ae,{className:"w-6 h-6 text-white"}):e.jsx(ze,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:m.name}),m.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-1",children:m.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:m.item_count.toLocaleString()}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"items"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>xt(m),title:"Preview collection",children:e.jsx(ke,{className:"w-4 h-4"})}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>da(m),title:"View analytics",children:e.jsx(We,{className:"w-4 h-4"})}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>ma(m),title:"Share collection",children:e.jsx(pe,{className:"w-4 h-4"})}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>xa(m),title:"Export collection",children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>ha(m),title:"Real-time collaboration",children:e.jsx(qt,{className:"w-4 h-4"})}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>ht(m),title:"Collection settings",children:e.jsx($e,{className:"w-4 h-4"})}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>gt(m),className:"text-red-600 hover:text-red-700",title:"Delete collection",children:e.jsx(be,{className:"w-4 h-4"})})]})]})},m.id)};return k?e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(Bt,{onSave:ia,onCancel:()=>L(!1),className:"mb-6"})}):Q?e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx(hl,{onClose:()=>i(!1),onApplyTemplate:async(m,B)=>{j.success(`Template "${m.name}" applied to "${B}"`),i(!1)}})}):u?e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx(ul,{})}):d?e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx(gl,{})}):I?e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx(pl,{})}):ne?e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(bt,{className:"w-8 h-8 text-indigo-600"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"AI-Powered Features"}),e.jsx(os,{className:"w-6 h-6 text-yellow-500"})]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Leverage artificial intelligence for intelligent content management"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsx(gs,{onSuggestionAccept:va,maxSuggestions:3}),e.jsx(ps,{onSearch:fa,placeholder:"Search naturally... try 'show me action movies' or 'find productivity tools'"})]}),e.jsx("div",{className:"mb-8",children:e.jsx(ys,{item:{title:"Sample Content for AI Categorization",description:"This is a sample content item to demonstrate AI-powered categorization capabilities"},onCategorizationComplete:ja})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsx(bs,{userId:"demo-user",onActionImplement:wa}),e.jsx(vs,{onPredictionAction:Na})]}),e.jsx("div",{className:"mb-8",children:e.jsx(fs,{collections:Pe,onSuggestionApply:ka})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsx(js,{content:{title:"Sample Content",description:"Sample description for AI metadata extraction",fileType:"video/mp4",size:1024e3},onMetadataExtracted:Ca}),e.jsx(ws,{content:{title:"Sample Content",description:"Sample description for AI quality analysis"},onQualityImprovement:Ia})]}),e.jsx("div",{children:e.jsx(Ns,{onRuleToggle:_a,onRuleExecute:Sa})}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{onClick:()=>g(!1),className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Back to Collections"})})]}):e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Collections"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Organize your media with smart and manual collections"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"w-4 h-4"}),e.jsxs("span",{children:["Render: ",ee.renderTime.toFixed(1),"ms"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"w-4 h-4"}),e.jsxs("span",{children:["Items: ",le.length]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"w-4 h-4"}),e.jsxs("span",{children:["Page ",xe,"/",ye]})]})]})]})}),e.jsx(Ea,{tabs:fl,activeTab:t,onChangeTab:a,className:"mb-6"}),e.jsxs("div",{className:"mb-6 flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 flex-1",children:[e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(vt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx(ce,{placeholder:"Search collections...",value:s,onChange:m=>sa(m.target.value),className:`pl-10 ${nt?"border-blue-400":""}`}),nt&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx(ms,{className:"w-4 h-4 text-blue-600 animate-spin"})})]}),e.jsx(Z,{value:o,onChange:w,options:jl,className:"w-40"}),e.jsx(Z,{value:p,onChange:N,options:Nl,className:"w-40"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex items-center bg-gray-100 dark:bg-gray-800 rounded-lg p-1",children:wl.map(m=>{const B=m.icon;return e.jsx("button",{onClick:()=>A(m.value),className:`p-2 rounded ${_===m.value?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,title:m.label,children:e.jsx(B,{className:"w-4 h-4"})},m.value)})}),e.jsxs(v,{onClick:ut,className:"flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4"}),"Smart Collection"]}),e.jsxs(v,{variant:"outline",onClick:ua,className:"flex items-center gap-2",children:[e.jsx(ve,{className:"w-4 h-4"}),"Templates"]}),e.jsxs(v,{variant:"outline",onClick:ga,className:"flex items-center gap-2",children:[e.jsx(vt,{className:"w-4 h-4"}),"Advanced Search"]}),e.jsxs(v,{variant:"outline",onClick:pa,className:"flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4"}),"Automation"]}),e.jsxs(v,{variant:"outline",onClick:ya,className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"w-4 h-4"}),"Integrations"]}),e.jsxs(v,{variant:"outline",onClick:ba,className:"flex items-center gap-2 bg-indigo-50 border-indigo-200 text-indigo-600 hover:bg-indigo-100",children:[e.jsx(bt,{className:"w-4 h-4"}),"AI Features"]}),!1]})]}),e.jsxs("div",{className:"min-h-96",children:[c.length>0&&e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:[c.length," collection",c.length>1?"s":""," selected"]}),e.jsx(v,{variant:"ghost",size:"sm",onClick:mt,className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200",children:e.jsx(de,{className:"w-4 h-4"})})]}),e.jsx(v,{onClick:()=>$(!0),size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Bulk Actions"})]}),le.length>0&&e.jsx("div",{className:"mb-4 flex items-center gap-4",children:e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("input",{type:"checkbox",checked:U,onChange:la,className:"rounded border-gray-300 dark:border-gray-600"}),"Select all (",le.length,")"]})}),De?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):le.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ze,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No collections found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:s||o!=="all"||t!=="all"?"Try adjusting your search or filters":"Create your first collection to get started"}),!s&&o==="all"&&t==="all"&&e.jsxs(v,{onClick:ut,className:"flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4"}),"Create Smart Collection"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Gs,{itemCount:ot.length,threshold:50,loadingStrategy:"lazy",itemHeight:_==="grid"?200:80,containerHeight:600,children:e.jsx("div",{className:_==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4":"space-y-4",children:ot.map(_==="grid"?Aa:Ta)})}),ye>1&&e.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Showing ",(xe-1)*20+1," to ",Math.min(xe*20,le.length)," of ",le.length," collections"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:ta,disabled:xe===1,children:"Previous"}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,ye)},(m,B)=>{let J;return ye<=5||xe<=3?J=B+1:xe>=ye-2?J=ye-4+B:J=xe-2+B,e.jsx(v,{variant:xe===J?"default":"outline",size:"sm",onClick:()=>aa(J),className:"min-w-[2.5rem]",children:J},J)})}),e.jsx(v,{variant:"outline",size:"sm",onClick:ea,disabled:xe===ye,children:"Next"})]})]})]})]}),S&&e.jsx(Hs,{collection:S,onClose:ra}),y&&e.jsx(tt,{selectedCollections:c,collections:le,onOperation:oa,onClose:()=>$(!1)}),H&&b&&e.jsx(tl,{collection:b,onClose:()=>O(!1),onSave:m=>{_e({id:b.id,updates:m}),O(!1)}}),z&&b&&e.jsx(Ht,{collection:b,onClose:()=>V(!1)}),F&&b&&e.jsx(il,{collection:b,onClose:()=>E(!1)}),x&&b&&e.jsx(dl,{collection:b,onClose:()=>f(!1)}),P&&b&&e.jsx(xl,{collection:b,onClose:()=>q(!1)})]})},El=Object.freeze(Object.defineProperty({__proto__:null,Collections:kl},Symbol.toStringTag,{value:"Module"}));export{El as C,G as S};
//# sourceMappingURL=Collections-CnjrFI1E.js.map
